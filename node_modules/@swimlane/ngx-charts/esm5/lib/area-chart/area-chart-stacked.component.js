import { __decorate, __extends, __read, __spread, __values } from "tslib";
import { Component, Input, Output, EventEmitter, ViewEncapsulation, HostListener, ChangeDetectionStrategy, ContentChild } from '@angular/core';
import { scaleLinear, scalePoint, scaleTime } from 'd3-scale';
import { curveLinear } from 'd3-shape';
import { calculateViewDimensions } from '../common/view-dimensions.helper';
import { ColorHelper } from '../common/color.helper';
import { BaseChartComponent } from '../common/base-chart.component';
import { id } from '../utils/id';
import { getUniqueXDomainValues, getScaleType } from '../common/domain.helper';
import * as ɵngcc0 from '@angular/core';
import * as ɵngcc1 from '../common/charts/chart.component';
import * as ɵngcc2 from '@angular/common';
import * as ɵngcc3 from '../common/axes/x-axis.component';
import * as ɵngcc4 from '../common/axes/y-axis.component';
import * as ɵngcc5 from './area-series.component';
import * as ɵngcc6 from '../common/tooltip-area.component';
import * as ɵngcc7 from '../common/circle-series.component';
import * as ɵngcc8 from '../common/timeline/timeline.component';

var _c0 = ["tooltipTemplate"];
var _c1 = ["seriesTooltipTemplate"];
function AreaChartStackedComponent__svg_g_5_Template(rf, ctx) { if (rf & 1) {
    var _r136 = ɵngcc0.ɵɵgetCurrentView();
    ɵngcc0.ɵɵnamespaceSVG();
    ɵngcc0.ɵɵelementStart(0, "g", 7);
    ɵngcc0.ɵɵlistener("dimensionsChanged", function AreaChartStackedComponent__svg_g_5_Template__svg_g_dimensionsChanged_0_listener($event) { ɵngcc0.ɵɵrestoreView(_r136); var ctx_r135 = ɵngcc0.ɵɵnextContext(); return ctx_r135.updateXAxisHeight($event); });
    ɵngcc0.ɵɵelementEnd();
} if (rf & 2) {
    var ctx_r130 = ɵngcc0.ɵɵnextContext();
    ɵngcc0.ɵɵproperty("xScale", ctx_r130.xScale)("dims", ctx_r130.dims)("showGridLines", ctx_r130.showGridLines)("showLabel", ctx_r130.showXAxisLabel)("labelText", ctx_r130.xAxisLabel)("trimTicks", ctx_r130.trimXAxisTicks)("rotateTicks", ctx_r130.rotateXAxisTicks)("maxTickLength", ctx_r130.maxXAxisTickLength)("tickFormatting", ctx_r130.xAxisTickFormatting)("ticks", ctx_r130.xAxisTicks);
} }
function AreaChartStackedComponent__svg_g_6_Template(rf, ctx) { if (rf & 1) {
    var _r138 = ɵngcc0.ɵɵgetCurrentView();
    ɵngcc0.ɵɵnamespaceSVG();
    ɵngcc0.ɵɵelementStart(0, "g", 8);
    ɵngcc0.ɵɵlistener("dimensionsChanged", function AreaChartStackedComponent__svg_g_6_Template__svg_g_dimensionsChanged_0_listener($event) { ɵngcc0.ɵɵrestoreView(_r138); var ctx_r137 = ɵngcc0.ɵɵnextContext(); return ctx_r137.updateYAxisWidth($event); });
    ɵngcc0.ɵɵelementEnd();
} if (rf & 2) {
    var ctx_r131 = ɵngcc0.ɵɵnextContext();
    ɵngcc0.ɵɵproperty("yScale", ctx_r131.yScale)("dims", ctx_r131.dims)("showGridLines", ctx_r131.showGridLines)("showLabel", ctx_r131.showYAxisLabel)("labelText", ctx_r131.yAxisLabel)("trimTicks", ctx_r131.trimYAxisTicks)("maxTickLength", ctx_r131.maxYAxisTickLength)("tickFormatting", ctx_r131.yAxisTickFormatting)("ticks", ctx_r131.yAxisTicks);
} }
function AreaChartStackedComponent__svg_g_8_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵnamespaceSVG();
    ɵngcc0.ɵɵelementStart(0, "g");
    ɵngcc0.ɵɵelement(1, "g", 9);
    ɵngcc0.ɵɵelementEnd();
} if (rf & 2) {
    var series_r139 = ctx.$implicit;
    var ctx_r132 = ɵngcc0.ɵɵnextContext();
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("xScale", ctx_r132.xScale)("yScale", ctx_r132.yScale)("colors", ctx_r132.colors)("data", series_r139)("scaleType", ctx_r132.scaleType)("gradient", ctx_r132.gradient)("activeEntries", ctx_r132.activeEntries)("curve", ctx_r132.curve)("animations", ctx_r132.animations);
} }
function AreaChartStackedComponent__svg_g_9__svg_g_2_Template(rf, ctx) { if (rf & 1) {
    var _r143 = ɵngcc0.ɵɵgetCurrentView();
    ɵngcc0.ɵɵnamespaceSVG();
    ɵngcc0.ɵɵelementStart(0, "g");
    ɵngcc0.ɵɵelementStart(1, "g", 12);
    ɵngcc0.ɵɵlistener("select", function AreaChartStackedComponent__svg_g_9__svg_g_2_Template__svg_g_select_1_listener($event) { ɵngcc0.ɵɵrestoreView(_r143); var series_r141 = ctx.$implicit; var ctx_r142 = ɵngcc0.ɵɵnextContext(2); return ctx_r142.onClick($event, series_r141); })("activate", function AreaChartStackedComponent__svg_g_9__svg_g_2_Template__svg_g_activate_1_listener($event) { ɵngcc0.ɵɵrestoreView(_r143); var ctx_r144 = ɵngcc0.ɵɵnextContext(2); return ctx_r144.onActivate($event); })("deactivate", function AreaChartStackedComponent__svg_g_9__svg_g_2_Template__svg_g_deactivate_1_listener($event) { ɵngcc0.ɵɵrestoreView(_r143); var ctx_r145 = ɵngcc0.ɵɵnextContext(2); return ctx_r145.onDeactivate($event); });
    ɵngcc0.ɵɵelementEnd();
    ɵngcc0.ɵɵelementEnd();
} if (rf & 2) {
    var series_r141 = ctx.$implicit;
    var ctx_r140 = ɵngcc0.ɵɵnextContext(2);
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("xScale", ctx_r140.xScale)("yScale", ctx_r140.yScale)("colors", ctx_r140.colors)("activeEntries", ctx_r140.activeEntries)("data", series_r141)("scaleType", ctx_r140.scaleType)("visibleValue", ctx_r140.hoveredVertical)("tooltipDisabled", ctx_r140.tooltipDisabled)("tooltipTemplate", ctx_r140.tooltipTemplate);
} }
function AreaChartStackedComponent__svg_g_9_Template(rf, ctx) { if (rf & 1) {
    var _r147 = ɵngcc0.ɵɵgetCurrentView();
    ɵngcc0.ɵɵnamespaceSVG();
    ɵngcc0.ɵɵelementStart(0, "g", 10);
    ɵngcc0.ɵɵlistener("mouseleave", function AreaChartStackedComponent__svg_g_9_Template__svg_g_mouseleave_0_listener($event) { ɵngcc0.ɵɵrestoreView(_r147); var ctx_r146 = ɵngcc0.ɵɵnextContext(); return ctx_r146.hideCircles(); });
    ɵngcc0.ɵɵelementStart(1, "g", 11);
    ɵngcc0.ɵɵlistener("hover", function AreaChartStackedComponent__svg_g_9_Template__svg_g_hover_1_listener($event) { ɵngcc0.ɵɵrestoreView(_r147); var ctx_r148 = ɵngcc0.ɵɵnextContext(); return ctx_r148.updateHoveredVertical($event); });
    ɵngcc0.ɵɵelementEnd();
    ɵngcc0.ɵɵtemplate(2, AreaChartStackedComponent__svg_g_9__svg_g_2_Template, 2, 9, "g", 4);
    ɵngcc0.ɵɵelementEnd();
} if (rf & 2) {
    var ctx_r133 = ɵngcc0.ɵɵnextContext();
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("dims", ctx_r133.dims)("xSet", ctx_r133.xSet)("xScale", ctx_r133.xScale)("yScale", ctx_r133.yScale)("results", ctx_r133.results)("colors", ctx_r133.colors)("tooltipDisabled", ctx_r133.tooltipDisabled)("tooltipTemplate", ctx_r133.seriesTooltipTemplate);
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngForOf", ctx_r133.results)("ngForTrackBy", ctx_r133.trackBy);
} }
function AreaChartStackedComponent__svg_g_10__svg_g_1_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵnamespaceSVG();
    ɵngcc0.ɵɵelementStart(0, "g");
    ɵngcc0.ɵɵelement(1, "g", 14);
    ɵngcc0.ɵɵelementEnd();
} if (rf & 2) {
    var series_r150 = ctx.$implicit;
    var ctx_r149 = ɵngcc0.ɵɵnextContext(2);
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("xScale", ctx_r149.timelineXScale)("yScale", ctx_r149.timelineYScale)("colors", ctx_r149.colors)("data", series_r150)("scaleType", ctx_r149.scaleType)("gradient", ctx_r149.gradient)("curve", ctx_r149.curve)("animations", ctx_r149.animations);
} }
var _c2 = function (a0, a1) { return [a0, a1]; };
function AreaChartStackedComponent__svg_g_10_Template(rf, ctx) { if (rf & 1) {
    var _r152 = ɵngcc0.ɵɵgetCurrentView();
    ɵngcc0.ɵɵnamespaceSVG();
    ɵngcc0.ɵɵelementStart(0, "g", 13);
    ɵngcc0.ɵɵlistener("onDomainChange", function AreaChartStackedComponent__svg_g_10_Template__svg_g_onDomainChange_0_listener($event) { ɵngcc0.ɵɵrestoreView(_r152); var ctx_r151 = ɵngcc0.ɵɵnextContext(); return ctx_r151.updateDomain($event); });
    ɵngcc0.ɵɵtemplate(1, AreaChartStackedComponent__svg_g_10__svg_g_1_Template, 2, 8, "g", 4);
    ɵngcc0.ɵɵelementEnd();
} if (rf & 2) {
    var ctx_r134 = ɵngcc0.ɵɵnextContext();
    ɵngcc0.ɵɵproperty("results", ctx_r134.results)("view", ɵngcc0.ɵɵpureFunction2(10, _c2, ctx_r134.timelineWidth, ctx_r134.height))("height", ctx_r134.timelineHeight)("scheme", ctx_r134.scheme)("customColors", ctx_r134.customColors)("legend", ctx_r134.legend)("scaleType", ctx_r134.scaleType);
    ɵngcc0.ɵɵattribute("transform", ctx_r134.timelineTransform);
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngForOf", ctx_r134.results)("ngForTrackBy", ctx_r134.trackBy);
} }
var AreaChartStackedComponent = /** @class */ (function (_super) {
    __extends(AreaChartStackedComponent, _super);
    function AreaChartStackedComponent() {
        var _this = _super !== null && _super.apply(this, arguments) || this;
        _this.legend = false;
        _this.legendTitle = 'Legend';
        _this.legendPosition = 'right';
        _this.showGridLines = true;
        _this.curve = curveLinear;
        _this.activeEntries = [];
        _this.trimXAxisTicks = true;
        _this.trimYAxisTicks = true;
        _this.rotateXAxisTicks = true;
        _this.maxXAxisTickLength = 16;
        _this.maxYAxisTickLength = 16;
        _this.roundDomains = false;
        _this.tooltipDisabled = false;
        _this.activate = new EventEmitter();
        _this.deactivate = new EventEmitter();
        _this.margin = [10, 20, 10, 20];
        _this.xAxisHeight = 0;
        _this.yAxisWidth = 0;
        _this.timelineHeight = 50;
        _this.timelinePadding = 10;
        return _this;
    }
    AreaChartStackedComponent.prototype.update = function () {
        var _this = this;
        _super.prototype.update.call(this);
        this.dims = calculateViewDimensions({
            width: this.width,
            height: this.height,
            margins: this.margin,
            showXAxis: this.xAxis,
            showYAxis: this.yAxis,
            xAxisHeight: this.xAxisHeight,
            yAxisWidth: this.yAxisWidth,
            showXLabel: this.showXAxisLabel,
            showYLabel: this.showYAxisLabel,
            showLegend: this.legend,
            legendType: this.schemeType,
            legendPosition: this.legendPosition
        });
        if (this.timeline) {
            this.dims.height -= this.timelineHeight + this.margin[2] + this.timelinePadding;
        }
        this.xDomain = this.getXDomain();
        if (this.filteredDomain) {
            this.xDomain = this.filteredDomain;
        }
        this.yDomain = this.getYDomain();
        this.seriesDomain = this.getSeriesDomain();
        this.xScale = this.getXScale(this.xDomain, this.dims.width);
        this.yScale = this.getYScale(this.yDomain, this.dims.height);
        var _loop_1 = function (i) {
            var e_1, _a;
            var val = this_1.xSet[i];
            var d0 = 0;
            try {
                for (var _b = (e_1 = void 0, __values(this_1.results)), _c = _b.next(); !_c.done; _c = _b.next()) {
                    var group = _c.value;
                    var d = group.series.find(function (item) {
                        var a = item.name;
                        var b = val;
                        if (_this.scaleType === 'time') {
                            a = a.valueOf();
                            b = b.valueOf();
                        }
                        return a === b;
                    });
                    if (d) {
                        d.d0 = d0;
                        d.d1 = d0 + d.value;
                        d0 += d.value;
                    }
                    else {
                        d = {
                            name: val,
                            value: 0,
                            d0: d0,
                            d1: d0
                        };
                        group.series.push(d);
                    }
                }
            }
            catch (e_1_1) { e_1 = { error: e_1_1 }; }
            finally {
                try {
                    if (_c && !_c.done && (_a = _b.return)) _a.call(_b);
                }
                finally { if (e_1) throw e_1.error; }
            }
        };
        var this_1 = this;
        for (var i = 0; i < this.xSet.length; i++) {
            _loop_1(i);
        }
        this.updateTimeline();
        this.setColors();
        this.legendOptions = this.getLegendOptions();
        this.transform = "translate(" + this.dims.xOffset + " , " + this.margin[0] + ")";
        this.clipPathId = 'clip' + id().toString();
        this.clipPath = "url(#" + this.clipPathId + ")";
    };
    AreaChartStackedComponent.prototype.updateTimeline = function () {
        if (this.timeline) {
            this.timelineWidth = this.dims.width;
            this.timelineXDomain = this.getXDomain();
            this.timelineXScale = this.getXScale(this.timelineXDomain, this.timelineWidth);
            this.timelineYScale = this.getYScale(this.yDomain, this.timelineHeight);
            this.timelineTransform = "translate(" + this.dims.xOffset + ", " + -this.margin[2] + ")";
        }
    };
    AreaChartStackedComponent.prototype.getXDomain = function () {
        var values = getUniqueXDomainValues(this.results);
        this.scaleType = getScaleType(values);
        var domain = [];
        if (this.scaleType === 'linear') {
            values = values.map(function (v) { return Number(v); });
        }
        var min;
        var max;
        if (this.scaleType === 'time' || this.scaleType === 'linear') {
            min = this.xScaleMin ? this.xScaleMin : Math.min.apply(Math, __spread(values));
            max = this.xScaleMax ? this.xScaleMax : Math.max.apply(Math, __spread(values));
        }
        if (this.scaleType === 'time') {
            domain = [new Date(min), new Date(max)];
            this.xSet = __spread(values).sort(function (a, b) {
                var aDate = a.getTime();
                var bDate = b.getTime();
                if (aDate > bDate)
                    return 1;
                if (bDate > aDate)
                    return -1;
                return 0;
            });
        }
        else if (this.scaleType === 'linear') {
            domain = [min, max];
            // Use compare function to sort numbers numerically
            this.xSet = __spread(values).sort(function (a, b) { return a - b; });
        }
        else {
            domain = values;
            this.xSet = values;
        }
        return domain;
    };
    AreaChartStackedComponent.prototype.getYDomain = function () {
        var _this = this;
        var domain = [];
        var _loop_2 = function (i) {
            var e_2, _a;
            var val = this_2.xSet[i];
            var sum = 0;
            try {
                for (var _b = (e_2 = void 0, __values(this_2.results)), _c = _b.next(); !_c.done; _c = _b.next()) {
                    var group = _c.value;
                    var d = group.series.find(function (item) {
                        var a = item.name;
                        var b = val;
                        if (_this.scaleType === 'time') {
                            a = a.valueOf();
                            b = b.valueOf();
                        }
                        return a === b;
                    });
                    if (d) {
                        sum += d.value;
                    }
                }
            }
            catch (e_2_1) { e_2 = { error: e_2_1 }; }
            finally {
                try {
                    if (_c && !_c.done && (_a = _b.return)) _a.call(_b);
                }
                finally { if (e_2) throw e_2.error; }
            }
            domain.push(sum);
        };
        var this_2 = this;
        for (var i = 0; i < this.xSet.length; i++) {
            _loop_2(i);
        }
        var min = this.yScaleMin ? this.yScaleMin : Math.min.apply(Math, __spread([0], domain));
        var max = this.yScaleMax ? this.yScaleMax : Math.max.apply(Math, __spread(domain));
        return [min, max];
    };
    AreaChartStackedComponent.prototype.getSeriesDomain = function () {
        return this.results.map(function (d) { return d.name; });
    };
    AreaChartStackedComponent.prototype.getXScale = function (domain, width) {
        var scale;
        if (this.scaleType === 'time') {
            scale = scaleTime();
        }
        else if (this.scaleType === 'linear') {
            scale = scaleLinear();
        }
        else if (this.scaleType === 'ordinal') {
            scale = scalePoint().padding(0.1);
        }
        scale.range([0, width]).domain(domain);
        return this.roundDomains ? scale.nice() : scale;
    };
    AreaChartStackedComponent.prototype.getYScale = function (domain, height) {
        var scale = scaleLinear()
            .range([height, 0])
            .domain(domain);
        return this.roundDomains ? scale.nice() : scale;
    };
    AreaChartStackedComponent.prototype.updateDomain = function (domain) {
        this.filteredDomain = domain;
        this.xDomain = this.filteredDomain;
        this.xScale = this.getXScale(this.xDomain, this.dims.width);
    };
    AreaChartStackedComponent.prototype.updateHoveredVertical = function (item) {
        this.hoveredVertical = item.value;
        this.deactivateAll();
    };
    AreaChartStackedComponent.prototype.hideCircles = function () {
        this.hoveredVertical = null;
        this.deactivateAll();
    };
    AreaChartStackedComponent.prototype.onClick = function (data, series) {
        if (series) {
            data.series = series.name;
        }
        this.select.emit(data);
    };
    AreaChartStackedComponent.prototype.trackBy = function (index, item) {
        return item.name;
    };
    AreaChartStackedComponent.prototype.setColors = function () {
        var domain;
        if (this.schemeType === 'ordinal') {
            domain = this.seriesDomain;
        }
        else {
            domain = this.yDomain;
        }
        this.colors = new ColorHelper(this.scheme, this.schemeType, domain, this.customColors);
    };
    AreaChartStackedComponent.prototype.getLegendOptions = function () {
        var opts = {
            scaleType: this.schemeType,
            colors: undefined,
            domain: [],
            title: undefined,
            position: this.legendPosition
        };
        if (opts.scaleType === 'ordinal') {
            opts.domain = this.seriesDomain;
            opts.colors = this.colors;
            opts.title = this.legendTitle;
        }
        else {
            opts.domain = this.yDomain;
            opts.colors = this.colors.scale;
        }
        return opts;
    };
    AreaChartStackedComponent.prototype.updateYAxisWidth = function (_a) {
        var width = _a.width;
        this.yAxisWidth = width;
        this.update();
    };
    AreaChartStackedComponent.prototype.updateXAxisHeight = function (_a) {
        var height = _a.height;
        this.xAxisHeight = height;
        this.update();
    };
    AreaChartStackedComponent.prototype.onActivate = function (item) {
        var idx = this.activeEntries.findIndex(function (d) {
            return d.name === item.name && d.value === item.value;
        });
        if (idx > -1) {
            return;
        }
        this.activeEntries = __spread([item], this.activeEntries);
        this.activate.emit({ value: item, entries: this.activeEntries });
    };
    AreaChartStackedComponent.prototype.onDeactivate = function (item) {
        var idx = this.activeEntries.findIndex(function (d) {
            return d.name === item.name && d.value === item.value;
        });
        this.activeEntries.splice(idx, 1);
        this.activeEntries = __spread(this.activeEntries);
        this.deactivate.emit({ value: item, entries: this.activeEntries });
    };
    AreaChartStackedComponent.prototype.deactivateAll = function () {
        var e_3, _a;
        this.activeEntries = __spread(this.activeEntries);
        try {
            for (var _b = __values(this.activeEntries), _c = _b.next(); !_c.done; _c = _b.next()) {
                var entry = _c.value;
                this.deactivate.emit({ value: entry, entries: [] });
            }
        }
        catch (e_3_1) { e_3 = { error: e_3_1 }; }
        finally {
            try {
                if (_c && !_c.done && (_a = _b.return)) _a.call(_b);
            }
            finally { if (e_3) throw e_3.error; }
        }
        this.activeEntries = [];
    };
    __decorate([
        Input()
    ], AreaChartStackedComponent.prototype, "legend", void 0);
    __decorate([
        Input()
    ], AreaChartStackedComponent.prototype, "legendTitle", void 0);
    __decorate([
        Input()
    ], AreaChartStackedComponent.prototype, "legendPosition", void 0);
    __decorate([
        Input()
    ], AreaChartStackedComponent.prototype, "xAxis", void 0);
    __decorate([
        Input()
    ], AreaChartStackedComponent.prototype, "yAxis", void 0);
    __decorate([
        Input()
    ], AreaChartStackedComponent.prototype, "showXAxisLabel", void 0);
    __decorate([
        Input()
    ], AreaChartStackedComponent.prototype, "showYAxisLabel", void 0);
    __decorate([
        Input()
    ], AreaChartStackedComponent.prototype, "xAxisLabel", void 0);
    __decorate([
        Input()
    ], AreaChartStackedComponent.prototype, "yAxisLabel", void 0);
    __decorate([
        Input()
    ], AreaChartStackedComponent.prototype, "timeline", void 0);
    __decorate([
        Input()
    ], AreaChartStackedComponent.prototype, "gradient", void 0);
    __decorate([
        Input()
    ], AreaChartStackedComponent.prototype, "showGridLines", void 0);
    __decorate([
        Input()
    ], AreaChartStackedComponent.prototype, "curve", void 0);
    __decorate([
        Input()
    ], AreaChartStackedComponent.prototype, "activeEntries", void 0);
    __decorate([
        Input()
    ], AreaChartStackedComponent.prototype, "schemeType", void 0);
    __decorate([
        Input()
    ], AreaChartStackedComponent.prototype, "trimXAxisTicks", void 0);
    __decorate([
        Input()
    ], AreaChartStackedComponent.prototype, "trimYAxisTicks", void 0);
    __decorate([
        Input()
    ], AreaChartStackedComponent.prototype, "rotateXAxisTicks", void 0);
    __decorate([
        Input()
    ], AreaChartStackedComponent.prototype, "maxXAxisTickLength", void 0);
    __decorate([
        Input()
    ], AreaChartStackedComponent.prototype, "maxYAxisTickLength", void 0);
    __decorate([
        Input()
    ], AreaChartStackedComponent.prototype, "xAxisTickFormatting", void 0);
    __decorate([
        Input()
    ], AreaChartStackedComponent.prototype, "yAxisTickFormatting", void 0);
    __decorate([
        Input()
    ], AreaChartStackedComponent.prototype, "xAxisTicks", void 0);
    __decorate([
        Input()
    ], AreaChartStackedComponent.prototype, "yAxisTicks", void 0);
    __decorate([
        Input()
    ], AreaChartStackedComponent.prototype, "roundDomains", void 0);
    __decorate([
        Input()
    ], AreaChartStackedComponent.prototype, "tooltipDisabled", void 0);
    __decorate([
        Input()
    ], AreaChartStackedComponent.prototype, "xScaleMin", void 0);
    __decorate([
        Input()
    ], AreaChartStackedComponent.prototype, "xScaleMax", void 0);
    __decorate([
        Input()
    ], AreaChartStackedComponent.prototype, "yScaleMin", void 0);
    __decorate([
        Input()
    ], AreaChartStackedComponent.prototype, "yScaleMax", void 0);
    __decorate([
        Output()
    ], AreaChartStackedComponent.prototype, "activate", void 0);
    __decorate([
        Output()
    ], AreaChartStackedComponent.prototype, "deactivate", void 0);
    __decorate([
        ContentChild('tooltipTemplate')
    ], AreaChartStackedComponent.prototype, "tooltipTemplate", void 0);
    __decorate([
        ContentChild('seriesTooltipTemplate')
    ], AreaChartStackedComponent.prototype, "seriesTooltipTemplate", void 0);
    __decorate([
        HostListener('mouseleave')
    ], AreaChartStackedComponent.prototype, "hideCircles", null);
AreaChartStackedComponent.ɵfac = function AreaChartStackedComponent_Factory(t) { return ɵAreaChartStackedComponent_BaseFactory(t || AreaChartStackedComponent); };
AreaChartStackedComponent.ɵcmp = ɵngcc0.ɵɵdefineComponent({ type: AreaChartStackedComponent, selectors: [["ngx-charts-area-chart-stacked"]], contentQueries: function AreaChartStackedComponent_ContentQueries(rf, ctx, dirIndex) { if (rf & 1) {
        ɵngcc0.ɵɵcontentQuery(dirIndex, _c0, true);
        ɵngcc0.ɵɵcontentQuery(dirIndex, _c1, true);
    } if (rf & 2) {
        var _t;
        ɵngcc0.ɵɵqueryRefresh(_t = ɵngcc0.ɵɵloadQuery()) && (ctx.tooltipTemplate = _t.first);
        ɵngcc0.ɵɵqueryRefresh(_t = ɵngcc0.ɵɵloadQuery()) && (ctx.seriesTooltipTemplate = _t.first);
    } }, hostBindings: function AreaChartStackedComponent_HostBindings(rf, ctx) { if (rf & 1) {
        ɵngcc0.ɵɵlistener("mouseleave", function AreaChartStackedComponent_mouseleave_HostBindingHandler($event) { return ctx.hideCircles(); });
    } }, inputs: { activeEntries: "activeEntries", legend: "legend", legendTitle: "legendTitle", legendPosition: "legendPosition", xAxis: "xAxis", yAxis: "yAxis", showXAxisLabel: "showXAxisLabel", showYAxisLabel: "showYAxisLabel", xAxisLabel: "xAxisLabel", yAxisLabel: "yAxisLabel", timeline: "timeline", gradient: "gradient", showGridLines: "showGridLines", curve: "curve", schemeType: "schemeType", trimXAxisTicks: "trimXAxisTicks", trimYAxisTicks: "trimYAxisTicks", rotateXAxisTicks: "rotateXAxisTicks", maxXAxisTickLength: "maxXAxisTickLength", maxYAxisTickLength: "maxYAxisTickLength", xAxisTickFormatting: "xAxisTickFormatting", yAxisTickFormatting: "yAxisTickFormatting", xAxisTicks: "xAxisTicks", yAxisTicks: "yAxisTicks", roundDomains: "roundDomains", tooltipDisabled: "tooltipDisabled", xScaleMin: "xScaleMin", xScaleMax: "xScaleMax", yScaleMin: "yScaleMin", yScaleMax: "yScaleMax" }, outputs: { activate: "activate", deactivate: "deactivate" }, features: [ɵngcc0.ɵɵInheritDefinitionFeature], decls: 11, vars: 20, consts: [[3, "view", "showLegend", "legendOptions", "activeEntries", "animations", "legendLabelClick", "legendLabelActivate", "legendLabelDeactivate"], [1, "area-chart", "chart"], ["ngx-charts-x-axis", "", 3, "xScale", "dims", "showGridLines", "showLabel", "labelText", "trimTicks", "rotateTicks", "maxTickLength", "tickFormatting", "ticks", "dimensionsChanged", 4, "ngIf"], ["ngx-charts-y-axis", "", 3, "yScale", "dims", "showGridLines", "showLabel", "labelText", "trimTicks", "maxTickLength", "tickFormatting", "ticks", "dimensionsChanged", 4, "ngIf"], [4, "ngFor", "ngForOf", "ngForTrackBy"], [3, "mouseleave", 4, "ngIf"], ["ngx-charts-timeline", "", 3, "results", "view", "height", "scheme", "customColors", "legend", "scaleType", "onDomainChange", 4, "ngIf"], ["ngx-charts-x-axis", "", 3, "xScale", "dims", "showGridLines", "showLabel", "labelText", "trimTicks", "rotateTicks", "maxTickLength", "tickFormatting", "ticks", "dimensionsChanged"], ["ngx-charts-y-axis", "", 3, "yScale", "dims", "showGridLines", "showLabel", "labelText", "trimTicks", "maxTickLength", "tickFormatting", "ticks", "dimensionsChanged"], ["ngx-charts-area-series", "", "stacked", "true", 3, "xScale", "yScale", "colors", "data", "scaleType", "gradient", "activeEntries", "curve", "animations"], [3, "mouseleave"], ["ngx-charts-tooltip-area", "", 3, "dims", "xSet", "xScale", "yScale", "results", "colors", "tooltipDisabled", "tooltipTemplate", "hover"], ["ngx-charts-circle-series", "", "type", "stacked", 3, "xScale", "yScale", "colors", "activeEntries", "data", "scaleType", "visibleValue", "tooltipDisabled", "tooltipTemplate", "select", "activate", "deactivate"], ["ngx-charts-timeline", "", 3, "results", "view", "height", "scheme", "customColors", "legend", "scaleType", "onDomainChange"], ["ngx-charts-area-series", "", "stacked", "true", 3, "xScale", "yScale", "colors", "data", "scaleType", "gradient", "curve", "animations"]], template: function AreaChartStackedComponent_Template(rf, ctx) { if (rf & 1) {
        ɵngcc0.ɵɵelementStart(0, "ngx-charts-chart", 0);
        ɵngcc0.ɵɵlistener("legendLabelClick", function AreaChartStackedComponent_Template_ngx_charts_chart_legendLabelClick_0_listener($event) { return ctx.onClick($event); })("legendLabelActivate", function AreaChartStackedComponent_Template_ngx_charts_chart_legendLabelActivate_0_listener($event) { return ctx.onActivate($event); })("legendLabelDeactivate", function AreaChartStackedComponent_Template_ngx_charts_chart_legendLabelDeactivate_0_listener($event) { return ctx.onDeactivate($event); });
        ɵngcc0.ɵɵnamespaceSVG();
        ɵngcc0.ɵɵelementStart(1, "defs");
        ɵngcc0.ɵɵelementStart(2, "clipPath");
        ɵngcc0.ɵɵelement(3, "rect");
        ɵngcc0.ɵɵelementEnd();
        ɵngcc0.ɵɵelementEnd();
        ɵngcc0.ɵɵelementStart(4, "g", 1);
        ɵngcc0.ɵɵtemplate(5, AreaChartStackedComponent__svg_g_5_Template, 1, 10, "g", 2);
        ɵngcc0.ɵɵtemplate(6, AreaChartStackedComponent__svg_g_6_Template, 1, 9, "g", 3);
        ɵngcc0.ɵɵelementStart(7, "g");
        ɵngcc0.ɵɵtemplate(8, AreaChartStackedComponent__svg_g_8_Template, 2, 9, "g", 4);
        ɵngcc0.ɵɵtemplate(9, AreaChartStackedComponent__svg_g_9_Template, 3, 10, "g", 5);
        ɵngcc0.ɵɵelementEnd();
        ɵngcc0.ɵɵelementEnd();
        ɵngcc0.ɵɵtemplate(10, AreaChartStackedComponent__svg_g_10_Template, 2, 13, "g", 6);
        ɵngcc0.ɵɵelementEnd();
    } if (rf & 2) {
        ɵngcc0.ɵɵproperty("view", ɵngcc0.ɵɵpureFunction2(17, _c2, ctx.width, ctx.height))("showLegend", ctx.legend)("legendOptions", ctx.legendOptions)("activeEntries", ctx.activeEntries)("animations", ctx.animations);
        ɵngcc0.ɵɵadvance(2);
        ɵngcc0.ɵɵattribute("id", ctx.clipPathId);
        ɵngcc0.ɵɵadvance(1);
        ɵngcc0.ɵɵattribute("width", ctx.dims.width + 10)("height", ctx.dims.height + 10)("transform", "translate(-5, -5)");
        ɵngcc0.ɵɵadvance(1);
        ɵngcc0.ɵɵattribute("transform", ctx.transform);
        ɵngcc0.ɵɵadvance(1);
        ɵngcc0.ɵɵproperty("ngIf", ctx.xAxis);
        ɵngcc0.ɵɵadvance(1);
        ɵngcc0.ɵɵproperty("ngIf", ctx.yAxis);
        ɵngcc0.ɵɵadvance(1);
        ɵngcc0.ɵɵattribute("clip-path", ctx.clipPath);
        ɵngcc0.ɵɵadvance(1);
        ɵngcc0.ɵɵproperty("ngForOf", ctx.results)("ngForTrackBy", ctx.trackBy);
        ɵngcc0.ɵɵadvance(1);
        ɵngcc0.ɵɵproperty("ngIf", !ctx.tooltipDisabled);
        ɵngcc0.ɵɵadvance(1);
        ɵngcc0.ɵɵproperty("ngIf", ctx.timeline && ctx.scaleType != "ordinal");
    } }, directives: [ɵngcc1.ChartComponent, ɵngcc2.NgIf, ɵngcc2.NgForOf, ɵngcc3.XAxisComponent, ɵngcc4.YAxisComponent, ɵngcc5.AreaSeriesComponent, ɵngcc6.TooltipArea, ɵngcc7.CircleSeriesComponent, ɵngcc8.Timeline], styles: [".ngx-charts{float:left;overflow:visible}.ngx-charts .arc,.ngx-charts .bar,.ngx-charts .circle{cursor:pointer}.ngx-charts .arc.active,.ngx-charts .arc:hover,.ngx-charts .bar.active,.ngx-charts .bar:hover,.ngx-charts .card.active,.ngx-charts .card:hover,.ngx-charts .cell.active,.ngx-charts .cell:hover{opacity:.8;-webkit-transition:opacity .1s ease-in-out;transition:opacity .1s ease-in-out}.ngx-charts .arc:focus,.ngx-charts .bar:focus,.ngx-charts .card:focus,.ngx-charts .cell:focus{outline:0}.ngx-charts .arc.hidden,.ngx-charts .bar.hidden,.ngx-charts .card.hidden,.ngx-charts .cell.hidden{display:none}.ngx-charts g:focus{outline:0}.ngx-charts .area-series.inactive,.ngx-charts .line-series-range.inactive,.ngx-charts .line-series.inactive,.ngx-charts .polar-series-area.inactive,.ngx-charts .polar-series-path.inactive{-webkit-transition:opacity .1s ease-in-out;transition:opacity .1s ease-in-out;opacity:.2}.ngx-charts .line-highlight{display:none}.ngx-charts .line-highlight.active{display:block}.ngx-charts .area{opacity:.6}.ngx-charts .circle:hover{cursor:pointer}.ngx-charts .label{font-size:12px;font-weight:400}.ngx-charts .tooltip-anchor{fill:#000}.ngx-charts .gridline-path{stroke:#ddd;stroke-width:1;fill:none}.ngx-charts .refline-path{stroke:#a8b2c7;stroke-width:1;stroke-dasharray:5;stroke-dashoffset:5}.ngx-charts .refline-label{font-size:9px}.ngx-charts .reference-area{fill-opacity:.05;fill:#000}.ngx-charts .gridline-path-dotted{stroke:#ddd;stroke-width:1;fill:none;stroke-dasharray:1,20;stroke-dashoffset:3}.ngx-charts .grid-panel rect{fill:none}.ngx-charts .grid-panel.odd rect{fill:rgba(0,0,0,.05)}"], encapsulation: 2, changeDetection: 0 });
var ɵAreaChartStackedComponent_BaseFactory = ɵngcc0.ɵɵgetInheritedFactory(AreaChartStackedComponent);
/*@__PURE__*/ (function () { ɵngcc0.ɵsetClassMetadata(AreaChartStackedComponent, [{
        type: Component,
        args: [{
                selector: 'ngx-charts-area-chart-stacked',
                template: "\n    <ngx-charts-chart\n      [view]=\"[width, height]\"\n      [showLegend]=\"legend\"\n      [legendOptions]=\"legendOptions\"\n      [activeEntries]=\"activeEntries\"\n      [animations]=\"animations\"\n      (legendLabelClick)=\"onClick($event)\"\n      (legendLabelActivate)=\"onActivate($event)\"\n      (legendLabelDeactivate)=\"onDeactivate($event)\"\n    >\n      <svg:defs>\n        <svg:clipPath [attr.id]=\"clipPathId\">\n          <svg:rect\n            [attr.width]=\"dims.width + 10\"\n            [attr.height]=\"dims.height + 10\"\n            [attr.transform]=\"'translate(-5, -5)'\"\n          />\n        </svg:clipPath>\n      </svg:defs>\n      <svg:g [attr.transform]=\"transform\" class=\"area-chart chart\">\n        <svg:g\n          ngx-charts-x-axis\n          *ngIf=\"xAxis\"\n          [xScale]=\"xScale\"\n          [dims]=\"dims\"\n          [showGridLines]=\"showGridLines\"\n          [showLabel]=\"showXAxisLabel\"\n          [labelText]=\"xAxisLabel\"\n          [trimTicks]=\"trimXAxisTicks\"\n          [rotateTicks]=\"rotateXAxisTicks\"\n          [maxTickLength]=\"maxXAxisTickLength\"\n          [tickFormatting]=\"xAxisTickFormatting\"\n          [ticks]=\"xAxisTicks\"\n          (dimensionsChanged)=\"updateXAxisHeight($event)\"\n        ></svg:g>\n        <svg:g\n          ngx-charts-y-axis\n          *ngIf=\"yAxis\"\n          [yScale]=\"yScale\"\n          [dims]=\"dims\"\n          [showGridLines]=\"showGridLines\"\n          [showLabel]=\"showYAxisLabel\"\n          [labelText]=\"yAxisLabel\"\n          [trimTicks]=\"trimYAxisTicks\"\n          [maxTickLength]=\"maxYAxisTickLength\"\n          [tickFormatting]=\"yAxisTickFormatting\"\n          [ticks]=\"yAxisTicks\"\n          (dimensionsChanged)=\"updateYAxisWidth($event)\"\n        ></svg:g>\n        <svg:g [attr.clip-path]=\"clipPath\">\n          <svg:g *ngFor=\"let series of results; trackBy: trackBy\">\n            <svg:g\n              ngx-charts-area-series\n              [xScale]=\"xScale\"\n              [yScale]=\"yScale\"\n              [colors]=\"colors\"\n              [data]=\"series\"\n              [scaleType]=\"scaleType\"\n              [gradient]=\"gradient\"\n              [activeEntries]=\"activeEntries\"\n              stacked=\"true\"\n              [curve]=\"curve\"\n              [animations]=\"animations\"\n            />\n          </svg:g>\n\n          <svg:g *ngIf=\"!tooltipDisabled\" (mouseleave)=\"hideCircles()\">\n            <svg:g\n              ngx-charts-tooltip-area\n              [dims]=\"dims\"\n              [xSet]=\"xSet\"\n              [xScale]=\"xScale\"\n              [yScale]=\"yScale\"\n              [results]=\"results\"\n              [colors]=\"colors\"\n              [tooltipDisabled]=\"tooltipDisabled\"\n              [tooltipTemplate]=\"seriesTooltipTemplate\"\n              (hover)=\"updateHoveredVertical($event)\"\n            />\n\n            <svg:g *ngFor=\"let series of results; trackBy: trackBy\">\n              <svg:g\n                ngx-charts-circle-series\n                type=\"stacked\"\n                [xScale]=\"xScale\"\n                [yScale]=\"yScale\"\n                [colors]=\"colors\"\n                [activeEntries]=\"activeEntries\"\n                [data]=\"series\"\n                [scaleType]=\"scaleType\"\n                [visibleValue]=\"hoveredVertical\"\n                [tooltipDisabled]=\"tooltipDisabled\"\n                [tooltipTemplate]=\"tooltipTemplate\"\n                (select)=\"onClick($event, series)\"\n                (activate)=\"onActivate($event)\"\n                (deactivate)=\"onDeactivate($event)\"\n              />\n            </svg:g>\n          </svg:g>\n        </svg:g>\n      </svg:g>\n      <svg:g\n        ngx-charts-timeline\n        *ngIf=\"timeline && scaleType != 'ordinal'\"\n        [attr.transform]=\"timelineTransform\"\n        [results]=\"results\"\n        [view]=\"[timelineWidth, height]\"\n        [height]=\"timelineHeight\"\n        [scheme]=\"scheme\"\n        [customColors]=\"customColors\"\n        [legend]=\"legend\"\n        [scaleType]=\"scaleType\"\n        (onDomainChange)=\"updateDomain($event)\"\n      >\n        <svg:g *ngFor=\"let series of results; trackBy: trackBy\">\n          <svg:g\n            ngx-charts-area-series\n            [xScale]=\"timelineXScale\"\n            [yScale]=\"timelineYScale\"\n            [colors]=\"colors\"\n            [data]=\"series\"\n            [scaleType]=\"scaleType\"\n            [gradient]=\"gradient\"\n            stacked=\"true\"\n            [curve]=\"curve\"\n            [animations]=\"animations\"\n          />\n        </svg:g>\n      </svg:g>\n    </ngx-charts-chart>\n  ",
                changeDetection: ChangeDetectionStrategy.OnPush,
                encapsulation: ViewEncapsulation.None,
                styles: [".ngx-charts{float:left;overflow:visible}.ngx-charts .arc,.ngx-charts .bar,.ngx-charts .circle{cursor:pointer}.ngx-charts .arc.active,.ngx-charts .arc:hover,.ngx-charts .bar.active,.ngx-charts .bar:hover,.ngx-charts .card.active,.ngx-charts .card:hover,.ngx-charts .cell.active,.ngx-charts .cell:hover{opacity:.8;-webkit-transition:opacity .1s ease-in-out;transition:opacity .1s ease-in-out}.ngx-charts .arc:focus,.ngx-charts .bar:focus,.ngx-charts .card:focus,.ngx-charts .cell:focus{outline:0}.ngx-charts .arc.hidden,.ngx-charts .bar.hidden,.ngx-charts .card.hidden,.ngx-charts .cell.hidden{display:none}.ngx-charts g:focus{outline:0}.ngx-charts .area-series.inactive,.ngx-charts .line-series-range.inactive,.ngx-charts .line-series.inactive,.ngx-charts .polar-series-area.inactive,.ngx-charts .polar-series-path.inactive{-webkit-transition:opacity .1s ease-in-out;transition:opacity .1s ease-in-out;opacity:.2}.ngx-charts .line-highlight{display:none}.ngx-charts .line-highlight.active{display:block}.ngx-charts .area{opacity:.6}.ngx-charts .circle:hover{cursor:pointer}.ngx-charts .label{font-size:12px;font-weight:400}.ngx-charts .tooltip-anchor{fill:#000}.ngx-charts .gridline-path{stroke:#ddd;stroke-width:1;fill:none}.ngx-charts .refline-path{stroke:#a8b2c7;stroke-width:1;stroke-dasharray:5;stroke-dashoffset:5}.ngx-charts .refline-label{font-size:9px}.ngx-charts .reference-area{fill-opacity:.05;fill:#000}.ngx-charts .gridline-path-dotted{stroke:#ddd;stroke-width:1;fill:none;stroke-dasharray:1,20;stroke-dashoffset:3}.ngx-charts .grid-panel rect{fill:none}.ngx-charts .grid-panel.odd rect{fill:rgba(0,0,0,.05)}"]
            }]
    }], null, { hideCircles: [{
            type: HostListener,
            args: ['mouseleave']
        }], activeEntries: [{
            type: Input
        }], legend: [{
            type: Input
        }], legendTitle: [{
            type: Input
        }], legendPosition: [{
            type: Input
        }], xAxis: [{
            type: Input
        }], yAxis: [{
            type: Input
        }], showXAxisLabel: [{
            type: Input
        }], showYAxisLabel: [{
            type: Input
        }], xAxisLabel: [{
            type: Input
        }], yAxisLabel: [{
            type: Input
        }], timeline: [{
            type: Input
        }], gradient: [{
            type: Input
        }], showGridLines: [{
            type: Input
        }], curve: [{
            type: Input
        }], schemeType: [{
            type: Input
        }], trimXAxisTicks: [{
            type: Input
        }], trimYAxisTicks: [{
            type: Input
        }], rotateXAxisTicks: [{
            type: Input
        }], maxXAxisTickLength: [{
            type: Input
        }], maxYAxisTickLength: [{
            type: Input
        }], xAxisTickFormatting: [{
            type: Input
        }], yAxisTickFormatting: [{
            type: Input
        }], xAxisTicks: [{
            type: Input
        }], yAxisTicks: [{
            type: Input
        }], roundDomains: [{
            type: Input
        }], tooltipDisabled: [{
            type: Input
        }], xScaleMin: [{
            type: Input
        }], xScaleMax: [{
            type: Input
        }], yScaleMin: [{
            type: Input
        }], yScaleMax: [{
            type: Input
        }], activate: [{
            type: Output
        }], deactivate: [{
            type: Output
        }], tooltipTemplate: [{
            type: ContentChild,
            args: ['tooltipTemplate']
        }], seriesTooltipTemplate: [{
            type: ContentChild,
            args: ['seriesTooltipTemplate']
        }] }); })();
    return AreaChartStackedComponent;
}(BaseChartComponent));
export { AreaChartStackedComponent };

//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy9tYWNwcm8va3JpdHNhZGVlL1NWTi9DeWJlcnNvZnQvYXBleC9ub2RlX21vZHVsZXMvQHN3aW1sYW5lL25neC1jaGFydHMvZXNtNS9saWIvYXJlYS1jaGFydC9hcmVhLWNoYXJ0LXN0YWNrZWQuY29tcG9uZW50LmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBU0E7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7aUVBK1ppRTs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7b0JBUy9CIiwiZmlsZSI6ImFyZWEtY2hhcnQtc3RhY2tlZC5jb21wb25lbnQuanMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBfX2RlY29yYXRlLCBfX2V4dGVuZHMsIF9fcmVhZCwgX19zcHJlYWQsIF9fdmFsdWVzIH0gZnJvbSBcInRzbGliXCI7XG5pbXBvcnQgeyBDb21wb25lbnQsIElucHV0LCBPdXRwdXQsIEV2ZW50RW1pdHRlciwgVmlld0VuY2Fwc3VsYXRpb24sIEhvc3RMaXN0ZW5lciwgQ2hhbmdlRGV0ZWN0aW9uU3RyYXRlZ3ksIENvbnRlbnRDaGlsZCB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xuaW1wb3J0IHsgc2NhbGVMaW5lYXIsIHNjYWxlUG9pbnQsIHNjYWxlVGltZSB9IGZyb20gJ2QzLXNjYWxlJztcbmltcG9ydCB7IGN1cnZlTGluZWFyIH0gZnJvbSAnZDMtc2hhcGUnO1xuaW1wb3J0IHsgY2FsY3VsYXRlVmlld0RpbWVuc2lvbnMgfSBmcm9tICcuLi9jb21tb24vdmlldy1kaW1lbnNpb25zLmhlbHBlcic7XG5pbXBvcnQgeyBDb2xvckhlbHBlciB9IGZyb20gJy4uL2NvbW1vbi9jb2xvci5oZWxwZXInO1xuaW1wb3J0IHsgQmFzZUNoYXJ0Q29tcG9uZW50IH0gZnJvbSAnLi4vY29tbW9uL2Jhc2UtY2hhcnQuY29tcG9uZW50JztcbmltcG9ydCB7IGlkIH0gZnJvbSAnLi4vdXRpbHMvaWQnO1xuaW1wb3J0IHsgZ2V0VW5pcXVlWERvbWFpblZhbHVlcywgZ2V0U2NhbGVUeXBlIH0gZnJvbSAnLi4vY29tbW9uL2RvbWFpbi5oZWxwZXInO1xudmFyIEFyZWFDaGFydFN0YWNrZWRDb21wb25lbnQgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgX19leHRlbmRzKEFyZWFDaGFydFN0YWNrZWRDb21wb25lbnQsIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gQXJlYUNoYXJ0U3RhY2tlZENvbXBvbmVudCgpIHtcbiAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyICE9PSBudWxsICYmIF9zdXBlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpIHx8IHRoaXM7XG4gICAgICAgIF90aGlzLmxlZ2VuZCA9IGZhbHNlO1xuICAgICAgICBfdGhpcy5sZWdlbmRUaXRsZSA9ICdMZWdlbmQnO1xuICAgICAgICBfdGhpcy5sZWdlbmRQb3NpdGlvbiA9ICdyaWdodCc7XG4gICAgICAgIF90aGlzLnNob3dHcmlkTGluZXMgPSB0cnVlO1xuICAgICAgICBfdGhpcy5jdXJ2ZSA9IGN1cnZlTGluZWFyO1xuICAgICAgICBfdGhpcy5hY3RpdmVFbnRyaWVzID0gW107XG4gICAgICAgIF90aGlzLnRyaW1YQXhpc1RpY2tzID0gdHJ1ZTtcbiAgICAgICAgX3RoaXMudHJpbVlBeGlzVGlja3MgPSB0cnVlO1xuICAgICAgICBfdGhpcy5yb3RhdGVYQXhpc1RpY2tzID0gdHJ1ZTtcbiAgICAgICAgX3RoaXMubWF4WEF4aXNUaWNrTGVuZ3RoID0gMTY7XG4gICAgICAgIF90aGlzLm1heFlBeGlzVGlja0xlbmd0aCA9IDE2O1xuICAgICAgICBfdGhpcy5yb3VuZERvbWFpbnMgPSBmYWxzZTtcbiAgICAgICAgX3RoaXMudG9vbHRpcERpc2FibGVkID0gZmFsc2U7XG4gICAgICAgIF90aGlzLmFjdGl2YXRlID0gbmV3IEV2ZW50RW1pdHRlcigpO1xuICAgICAgICBfdGhpcy5kZWFjdGl2YXRlID0gbmV3IEV2ZW50RW1pdHRlcigpO1xuICAgICAgICBfdGhpcy5tYXJnaW4gPSBbMTAsIDIwLCAxMCwgMjBdO1xuICAgICAgICBfdGhpcy54QXhpc0hlaWdodCA9IDA7XG4gICAgICAgIF90aGlzLnlBeGlzV2lkdGggPSAwO1xuICAgICAgICBfdGhpcy50aW1lbGluZUhlaWdodCA9IDUwO1xuICAgICAgICBfdGhpcy50aW1lbGluZVBhZGRpbmcgPSAxMDtcbiAgICAgICAgcmV0dXJuIF90aGlzO1xuICAgIH1cbiAgICBBcmVhQ2hhcnRTdGFja2VkQ29tcG9uZW50LnByb3RvdHlwZS51cGRhdGUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIF9zdXBlci5wcm90b3R5cGUudXBkYXRlLmNhbGwodGhpcyk7XG4gICAgICAgIHRoaXMuZGltcyA9IGNhbGN1bGF0ZVZpZXdEaW1lbnNpb25zKHtcbiAgICAgICAgICAgIHdpZHRoOiB0aGlzLndpZHRoLFxuICAgICAgICAgICAgaGVpZ2h0OiB0aGlzLmhlaWdodCxcbiAgICAgICAgICAgIG1hcmdpbnM6IHRoaXMubWFyZ2luLFxuICAgICAgICAgICAgc2hvd1hBeGlzOiB0aGlzLnhBeGlzLFxuICAgICAgICAgICAgc2hvd1lBeGlzOiB0aGlzLnlBeGlzLFxuICAgICAgICAgICAgeEF4aXNIZWlnaHQ6IHRoaXMueEF4aXNIZWlnaHQsXG4gICAgICAgICAgICB5QXhpc1dpZHRoOiB0aGlzLnlBeGlzV2lkdGgsXG4gICAgICAgICAgICBzaG93WExhYmVsOiB0aGlzLnNob3dYQXhpc0xhYmVsLFxuICAgICAgICAgICAgc2hvd1lMYWJlbDogdGhpcy5zaG93WUF4aXNMYWJlbCxcbiAgICAgICAgICAgIHNob3dMZWdlbmQ6IHRoaXMubGVnZW5kLFxuICAgICAgICAgICAgbGVnZW5kVHlwZTogdGhpcy5zY2hlbWVUeXBlLFxuICAgICAgICAgICAgbGVnZW5kUG9zaXRpb246IHRoaXMubGVnZW5kUG9zaXRpb25cbiAgICAgICAgfSk7XG4gICAgICAgIGlmICh0aGlzLnRpbWVsaW5lKSB7XG4gICAgICAgICAgICB0aGlzLmRpbXMuaGVpZ2h0IC09IHRoaXMudGltZWxpbmVIZWlnaHQgKyB0aGlzLm1hcmdpblsyXSArIHRoaXMudGltZWxpbmVQYWRkaW5nO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMueERvbWFpbiA9IHRoaXMuZ2V0WERvbWFpbigpO1xuICAgICAgICBpZiAodGhpcy5maWx0ZXJlZERvbWFpbikge1xuICAgICAgICAgICAgdGhpcy54RG9tYWluID0gdGhpcy5maWx0ZXJlZERvbWFpbjtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnlEb21haW4gPSB0aGlzLmdldFlEb21haW4oKTtcbiAgICAgICAgdGhpcy5zZXJpZXNEb21haW4gPSB0aGlzLmdldFNlcmllc0RvbWFpbigpO1xuICAgICAgICB0aGlzLnhTY2FsZSA9IHRoaXMuZ2V0WFNjYWxlKHRoaXMueERvbWFpbiwgdGhpcy5kaW1zLndpZHRoKTtcbiAgICAgICAgdGhpcy55U2NhbGUgPSB0aGlzLmdldFlTY2FsZSh0aGlzLnlEb21haW4sIHRoaXMuZGltcy5oZWlnaHQpO1xuICAgICAgICB2YXIgX2xvb3BfMSA9IGZ1bmN0aW9uIChpKSB7XG4gICAgICAgICAgICB2YXIgZV8xLCBfYTtcbiAgICAgICAgICAgIHZhciB2YWwgPSB0aGlzXzEueFNldFtpXTtcbiAgICAgICAgICAgIHZhciBkMCA9IDA7XG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIGZvciAodmFyIF9iID0gKGVfMSA9IHZvaWQgMCwgX192YWx1ZXModGhpc18xLnJlc3VsdHMpKSwgX2MgPSBfYi5uZXh0KCk7ICFfYy5kb25lOyBfYyA9IF9iLm5leHQoKSkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgZ3JvdXAgPSBfYy52YWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGQgPSBncm91cC5zZXJpZXMuZmluZChmdW5jdGlvbiAoaXRlbSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGEgPSBpdGVtLm5hbWU7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgYiA9IHZhbDtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChfdGhpcy5zY2FsZVR5cGUgPT09ICd0aW1lJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGEgPSBhLnZhbHVlT2YoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBiID0gYi52YWx1ZU9mKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gYSA9PT0gYjtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBkLmQwID0gZDA7XG4gICAgICAgICAgICAgICAgICAgICAgICBkLmQxID0gZDAgKyBkLnZhbHVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgZDAgKz0gZC52YWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGQgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogdmFsLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlOiAwLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGQwOiBkMCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkMTogZDBcbiAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgICAgICBncm91cC5zZXJpZXMucHVzaChkKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNhdGNoIChlXzFfMSkgeyBlXzEgPSB7IGVycm9yOiBlXzFfMSB9OyB9XG4gICAgICAgICAgICBmaW5hbGx5IHtcbiAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoX2MgJiYgIV9jLmRvbmUgJiYgKF9hID0gX2IucmV0dXJuKSkgX2EuY2FsbChfYik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGZpbmFsbHkgeyBpZiAoZV8xKSB0aHJvdyBlXzEuZXJyb3I7IH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgdmFyIHRoaXNfMSA9IHRoaXM7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy54U2V0Lmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBfbG9vcF8xKGkpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMudXBkYXRlVGltZWxpbmUoKTtcbiAgICAgICAgdGhpcy5zZXRDb2xvcnMoKTtcbiAgICAgICAgdGhpcy5sZWdlbmRPcHRpb25zID0gdGhpcy5nZXRMZWdlbmRPcHRpb25zKCk7XG4gICAgICAgIHRoaXMudHJhbnNmb3JtID0gXCJ0cmFuc2xhdGUoXCIgKyB0aGlzLmRpbXMueE9mZnNldCArIFwiICwgXCIgKyB0aGlzLm1hcmdpblswXSArIFwiKVwiO1xuICAgICAgICB0aGlzLmNsaXBQYXRoSWQgPSAnY2xpcCcgKyBpZCgpLnRvU3RyaW5nKCk7XG4gICAgICAgIHRoaXMuY2xpcFBhdGggPSBcInVybCgjXCIgKyB0aGlzLmNsaXBQYXRoSWQgKyBcIilcIjtcbiAgICB9O1xuICAgIEFyZWFDaGFydFN0YWNrZWRDb21wb25lbnQucHJvdG90eXBlLnVwZGF0ZVRpbWVsaW5lID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAodGhpcy50aW1lbGluZSkge1xuICAgICAgICAgICAgdGhpcy50aW1lbGluZVdpZHRoID0gdGhpcy5kaW1zLndpZHRoO1xuICAgICAgICAgICAgdGhpcy50aW1lbGluZVhEb21haW4gPSB0aGlzLmdldFhEb21haW4oKTtcbiAgICAgICAgICAgIHRoaXMudGltZWxpbmVYU2NhbGUgPSB0aGlzLmdldFhTY2FsZSh0aGlzLnRpbWVsaW5lWERvbWFpbiwgdGhpcy50aW1lbGluZVdpZHRoKTtcbiAgICAgICAgICAgIHRoaXMudGltZWxpbmVZU2NhbGUgPSB0aGlzLmdldFlTY2FsZSh0aGlzLnlEb21haW4sIHRoaXMudGltZWxpbmVIZWlnaHQpO1xuICAgICAgICAgICAgdGhpcy50aW1lbGluZVRyYW5zZm9ybSA9IFwidHJhbnNsYXRlKFwiICsgdGhpcy5kaW1zLnhPZmZzZXQgKyBcIiwgXCIgKyAtdGhpcy5tYXJnaW5bMl0gKyBcIilcIjtcbiAgICAgICAgfVxuICAgIH07XG4gICAgQXJlYUNoYXJ0U3RhY2tlZENvbXBvbmVudC5wcm90b3R5cGUuZ2V0WERvbWFpbiA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIHZhbHVlcyA9IGdldFVuaXF1ZVhEb21haW5WYWx1ZXModGhpcy5yZXN1bHRzKTtcbiAgICAgICAgdGhpcy5zY2FsZVR5cGUgPSBnZXRTY2FsZVR5cGUodmFsdWVzKTtcbiAgICAgICAgdmFyIGRvbWFpbiA9IFtdO1xuICAgICAgICBpZiAodGhpcy5zY2FsZVR5cGUgPT09ICdsaW5lYXInKSB7XG4gICAgICAgICAgICB2YWx1ZXMgPSB2YWx1ZXMubWFwKGZ1bmN0aW9uICh2KSB7IHJldHVybiBOdW1iZXIodik7IH0pO1xuICAgICAgICB9XG4gICAgICAgIHZhciBtaW47XG4gICAgICAgIHZhciBtYXg7XG4gICAgICAgIGlmICh0aGlzLnNjYWxlVHlwZSA9PT0gJ3RpbWUnIHx8IHRoaXMuc2NhbGVUeXBlID09PSAnbGluZWFyJykge1xuICAgICAgICAgICAgbWluID0gdGhpcy54U2NhbGVNaW4gPyB0aGlzLnhTY2FsZU1pbiA6IE1hdGgubWluLmFwcGx5KE1hdGgsIF9fc3ByZWFkKHZhbHVlcykpO1xuICAgICAgICAgICAgbWF4ID0gdGhpcy54U2NhbGVNYXggPyB0aGlzLnhTY2FsZU1heCA6IE1hdGgubWF4LmFwcGx5KE1hdGgsIF9fc3ByZWFkKHZhbHVlcykpO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLnNjYWxlVHlwZSA9PT0gJ3RpbWUnKSB7XG4gICAgICAgICAgICBkb21haW4gPSBbbmV3IERhdGUobWluKSwgbmV3IERhdGUobWF4KV07XG4gICAgICAgICAgICB0aGlzLnhTZXQgPSBfX3NwcmVhZCh2YWx1ZXMpLnNvcnQoZnVuY3Rpb24gKGEsIGIpIHtcbiAgICAgICAgICAgICAgICB2YXIgYURhdGUgPSBhLmdldFRpbWUoKTtcbiAgICAgICAgICAgICAgICB2YXIgYkRhdGUgPSBiLmdldFRpbWUoKTtcbiAgICAgICAgICAgICAgICBpZiAoYURhdGUgPiBiRGF0ZSlcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIDE7XG4gICAgICAgICAgICAgICAgaWYgKGJEYXRlID4gYURhdGUpXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAtMTtcbiAgICAgICAgICAgICAgICByZXR1cm4gMDtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKHRoaXMuc2NhbGVUeXBlID09PSAnbGluZWFyJykge1xuICAgICAgICAgICAgZG9tYWluID0gW21pbiwgbWF4XTtcbiAgICAgICAgICAgIC8vIFVzZSBjb21wYXJlIGZ1bmN0aW9uIHRvIHNvcnQgbnVtYmVycyBudW1lcmljYWxseVxuICAgICAgICAgICAgdGhpcy54U2V0ID0gX19zcHJlYWQodmFsdWVzKS5zb3J0KGZ1bmN0aW9uIChhLCBiKSB7IHJldHVybiBhIC0gYjsgfSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBkb21haW4gPSB2YWx1ZXM7XG4gICAgICAgICAgICB0aGlzLnhTZXQgPSB2YWx1ZXM7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGRvbWFpbjtcbiAgICB9O1xuICAgIEFyZWFDaGFydFN0YWNrZWRDb21wb25lbnQucHJvdG90eXBlLmdldFlEb21haW4gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIHZhciBkb21haW4gPSBbXTtcbiAgICAgICAgdmFyIF9sb29wXzIgPSBmdW5jdGlvbiAoaSkge1xuICAgICAgICAgICAgdmFyIGVfMiwgX2E7XG4gICAgICAgICAgICB2YXIgdmFsID0gdGhpc18yLnhTZXRbaV07XG4gICAgICAgICAgICB2YXIgc3VtID0gMDtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgX2IgPSAoZV8yID0gdm9pZCAwLCBfX3ZhbHVlcyh0aGlzXzIucmVzdWx0cykpLCBfYyA9IF9iLm5leHQoKTsgIV9jLmRvbmU7IF9jID0gX2IubmV4dCgpKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBncm91cCA9IF9jLnZhbHVlO1xuICAgICAgICAgICAgICAgICAgICB2YXIgZCA9IGdyb3VwLnNlcmllcy5maW5kKGZ1bmN0aW9uIChpdGVtKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgYSA9IGl0ZW0ubmFtZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBiID0gdmFsO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKF90aGlzLnNjYWxlVHlwZSA9PT0gJ3RpbWUnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYSA9IGEudmFsdWVPZigpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGIgPSBiLnZhbHVlT2YoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBhID09PSBiO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHN1bSArPSBkLnZhbHVlO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY2F0Y2ggKGVfMl8xKSB7IGVfMiA9IHsgZXJyb3I6IGVfMl8xIH07IH1cbiAgICAgICAgICAgIGZpbmFsbHkge1xuICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChfYyAmJiAhX2MuZG9uZSAmJiAoX2EgPSBfYi5yZXR1cm4pKSBfYS5jYWxsKF9iKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZmluYWxseSB7IGlmIChlXzIpIHRocm93IGVfMi5lcnJvcjsgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZG9tYWluLnB1c2goc3VtKTtcbiAgICAgICAgfTtcbiAgICAgICAgdmFyIHRoaXNfMiA9IHRoaXM7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy54U2V0Lmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBfbG9vcF8yKGkpO1xuICAgICAgICB9XG4gICAgICAgIHZhciBtaW4gPSB0aGlzLnlTY2FsZU1pbiA/IHRoaXMueVNjYWxlTWluIDogTWF0aC5taW4uYXBwbHkoTWF0aCwgX19zcHJlYWQoWzBdLCBkb21haW4pKTtcbiAgICAgICAgdmFyIG1heCA9IHRoaXMueVNjYWxlTWF4ID8gdGhpcy55U2NhbGVNYXggOiBNYXRoLm1heC5hcHBseShNYXRoLCBfX3NwcmVhZChkb21haW4pKTtcbiAgICAgICAgcmV0dXJuIFttaW4sIG1heF07XG4gICAgfTtcbiAgICBBcmVhQ2hhcnRTdGFja2VkQ29tcG9uZW50LnByb3RvdHlwZS5nZXRTZXJpZXNEb21haW4gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnJlc3VsdHMubWFwKGZ1bmN0aW9uIChkKSB7IHJldHVybiBkLm5hbWU7IH0pO1xuICAgIH07XG4gICAgQXJlYUNoYXJ0U3RhY2tlZENvbXBvbmVudC5wcm90b3R5cGUuZ2V0WFNjYWxlID0gZnVuY3Rpb24gKGRvbWFpbiwgd2lkdGgpIHtcbiAgICAgICAgdmFyIHNjYWxlO1xuICAgICAgICBpZiAodGhpcy5zY2FsZVR5cGUgPT09ICd0aW1lJykge1xuICAgICAgICAgICAgc2NhbGUgPSBzY2FsZVRpbWUoKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmICh0aGlzLnNjYWxlVHlwZSA9PT0gJ2xpbmVhcicpIHtcbiAgICAgICAgICAgIHNjYWxlID0gc2NhbGVMaW5lYXIoKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmICh0aGlzLnNjYWxlVHlwZSA9PT0gJ29yZGluYWwnKSB7XG4gICAgICAgICAgICBzY2FsZSA9IHNjYWxlUG9pbnQoKS5wYWRkaW5nKDAuMSk7XG4gICAgICAgIH1cbiAgICAgICAgc2NhbGUucmFuZ2UoWzAsIHdpZHRoXSkuZG9tYWluKGRvbWFpbik7XG4gICAgICAgIHJldHVybiB0aGlzLnJvdW5kRG9tYWlucyA/IHNjYWxlLm5pY2UoKSA6IHNjYWxlO1xuICAgIH07XG4gICAgQXJlYUNoYXJ0U3RhY2tlZENvbXBvbmVudC5wcm90b3R5cGUuZ2V0WVNjYWxlID0gZnVuY3Rpb24gKGRvbWFpbiwgaGVpZ2h0KSB7XG4gICAgICAgIHZhciBzY2FsZSA9IHNjYWxlTGluZWFyKClcbiAgICAgICAgICAgIC5yYW5nZShbaGVpZ2h0LCAwXSlcbiAgICAgICAgICAgIC5kb21haW4oZG9tYWluKTtcbiAgICAgICAgcmV0dXJuIHRoaXMucm91bmREb21haW5zID8gc2NhbGUubmljZSgpIDogc2NhbGU7XG4gICAgfTtcbiAgICBBcmVhQ2hhcnRTdGFja2VkQ29tcG9uZW50LnByb3RvdHlwZS51cGRhdGVEb21haW4gPSBmdW5jdGlvbiAoZG9tYWluKSB7XG4gICAgICAgIHRoaXMuZmlsdGVyZWREb21haW4gPSBkb21haW47XG4gICAgICAgIHRoaXMueERvbWFpbiA9IHRoaXMuZmlsdGVyZWREb21haW47XG4gICAgICAgIHRoaXMueFNjYWxlID0gdGhpcy5nZXRYU2NhbGUodGhpcy54RG9tYWluLCB0aGlzLmRpbXMud2lkdGgpO1xuICAgIH07XG4gICAgQXJlYUNoYXJ0U3RhY2tlZENvbXBvbmVudC5wcm90b3R5cGUudXBkYXRlSG92ZXJlZFZlcnRpY2FsID0gZnVuY3Rpb24gKGl0ZW0pIHtcbiAgICAgICAgdGhpcy5ob3ZlcmVkVmVydGljYWwgPSBpdGVtLnZhbHVlO1xuICAgICAgICB0aGlzLmRlYWN0aXZhdGVBbGwoKTtcbiAgICB9O1xuICAgIEFyZWFDaGFydFN0YWNrZWRDb21wb25lbnQucHJvdG90eXBlLmhpZGVDaXJjbGVzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLmhvdmVyZWRWZXJ0aWNhbCA9IG51bGw7XG4gICAgICAgIHRoaXMuZGVhY3RpdmF0ZUFsbCgpO1xuICAgIH07XG4gICAgQXJlYUNoYXJ0U3RhY2tlZENvbXBvbmVudC5wcm90b3R5cGUub25DbGljayA9IGZ1bmN0aW9uIChkYXRhLCBzZXJpZXMpIHtcbiAgICAgICAgaWYgKHNlcmllcykge1xuICAgICAgICAgICAgZGF0YS5zZXJpZXMgPSBzZXJpZXMubmFtZTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnNlbGVjdC5lbWl0KGRhdGEpO1xuICAgIH07XG4gICAgQXJlYUNoYXJ0U3RhY2tlZENvbXBvbmVudC5wcm90b3R5cGUudHJhY2tCeSA9IGZ1bmN0aW9uIChpbmRleCwgaXRlbSkge1xuICAgICAgICByZXR1cm4gaXRlbS5uYW1lO1xuICAgIH07XG4gICAgQXJlYUNoYXJ0U3RhY2tlZENvbXBvbmVudC5wcm90b3R5cGUuc2V0Q29sb3JzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgZG9tYWluO1xuICAgICAgICBpZiAodGhpcy5zY2hlbWVUeXBlID09PSAnb3JkaW5hbCcpIHtcbiAgICAgICAgICAgIGRvbWFpbiA9IHRoaXMuc2VyaWVzRG9tYWluO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgZG9tYWluID0gdGhpcy55RG9tYWluO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuY29sb3JzID0gbmV3IENvbG9ySGVscGVyKHRoaXMuc2NoZW1lLCB0aGlzLnNjaGVtZVR5cGUsIGRvbWFpbiwgdGhpcy5jdXN0b21Db2xvcnMpO1xuICAgIH07XG4gICAgQXJlYUNoYXJ0U3RhY2tlZENvbXBvbmVudC5wcm90b3R5cGUuZ2V0TGVnZW5kT3B0aW9ucyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIG9wdHMgPSB7XG4gICAgICAgICAgICBzY2FsZVR5cGU6IHRoaXMuc2NoZW1lVHlwZSxcbiAgICAgICAgICAgIGNvbG9yczogdW5kZWZpbmVkLFxuICAgICAgICAgICAgZG9tYWluOiBbXSxcbiAgICAgICAgICAgIHRpdGxlOiB1bmRlZmluZWQsXG4gICAgICAgICAgICBwb3NpdGlvbjogdGhpcy5sZWdlbmRQb3NpdGlvblxuICAgICAgICB9O1xuICAgICAgICBpZiAob3B0cy5zY2FsZVR5cGUgPT09ICdvcmRpbmFsJykge1xuICAgICAgICAgICAgb3B0cy5kb21haW4gPSB0aGlzLnNlcmllc0RvbWFpbjtcbiAgICAgICAgICAgIG9wdHMuY29sb3JzID0gdGhpcy5jb2xvcnM7XG4gICAgICAgICAgICBvcHRzLnRpdGxlID0gdGhpcy5sZWdlbmRUaXRsZTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIG9wdHMuZG9tYWluID0gdGhpcy55RG9tYWluO1xuICAgICAgICAgICAgb3B0cy5jb2xvcnMgPSB0aGlzLmNvbG9ycy5zY2FsZTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gb3B0cztcbiAgICB9O1xuICAgIEFyZWFDaGFydFN0YWNrZWRDb21wb25lbnQucHJvdG90eXBlLnVwZGF0ZVlBeGlzV2lkdGggPSBmdW5jdGlvbiAoX2EpIHtcbiAgICAgICAgdmFyIHdpZHRoID0gX2Eud2lkdGg7XG4gICAgICAgIHRoaXMueUF4aXNXaWR0aCA9IHdpZHRoO1xuICAgICAgICB0aGlzLnVwZGF0ZSgpO1xuICAgIH07XG4gICAgQXJlYUNoYXJ0U3RhY2tlZENvbXBvbmVudC5wcm90b3R5cGUudXBkYXRlWEF4aXNIZWlnaHQgPSBmdW5jdGlvbiAoX2EpIHtcbiAgICAgICAgdmFyIGhlaWdodCA9IF9hLmhlaWdodDtcbiAgICAgICAgdGhpcy54QXhpc0hlaWdodCA9IGhlaWdodDtcbiAgICAgICAgdGhpcy51cGRhdGUoKTtcbiAgICB9O1xuICAgIEFyZWFDaGFydFN0YWNrZWRDb21wb25lbnQucHJvdG90eXBlLm9uQWN0aXZhdGUgPSBmdW5jdGlvbiAoaXRlbSkge1xuICAgICAgICB2YXIgaWR4ID0gdGhpcy5hY3RpdmVFbnRyaWVzLmZpbmRJbmRleChmdW5jdGlvbiAoZCkge1xuICAgICAgICAgICAgcmV0dXJuIGQubmFtZSA9PT0gaXRlbS5uYW1lICYmIGQudmFsdWUgPT09IGl0ZW0udmFsdWU7XG4gICAgICAgIH0pO1xuICAgICAgICBpZiAoaWR4ID4gLTEpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLmFjdGl2ZUVudHJpZXMgPSBfX3NwcmVhZChbaXRlbV0sIHRoaXMuYWN0aXZlRW50cmllcyk7XG4gICAgICAgIHRoaXMuYWN0aXZhdGUuZW1pdCh7IHZhbHVlOiBpdGVtLCBlbnRyaWVzOiB0aGlzLmFjdGl2ZUVudHJpZXMgfSk7XG4gICAgfTtcbiAgICBBcmVhQ2hhcnRTdGFja2VkQ29tcG9uZW50LnByb3RvdHlwZS5vbkRlYWN0aXZhdGUgPSBmdW5jdGlvbiAoaXRlbSkge1xuICAgICAgICB2YXIgaWR4ID0gdGhpcy5hY3RpdmVFbnRyaWVzLmZpbmRJbmRleChmdW5jdGlvbiAoZCkge1xuICAgICAgICAgICAgcmV0dXJuIGQubmFtZSA9PT0gaXRlbS5uYW1lICYmIGQudmFsdWUgPT09IGl0ZW0udmFsdWU7XG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLmFjdGl2ZUVudHJpZXMuc3BsaWNlKGlkeCwgMSk7XG4gICAgICAgIHRoaXMuYWN0aXZlRW50cmllcyA9IF9fc3ByZWFkKHRoaXMuYWN0aXZlRW50cmllcyk7XG4gICAgICAgIHRoaXMuZGVhY3RpdmF0ZS5lbWl0KHsgdmFsdWU6IGl0ZW0sIGVudHJpZXM6IHRoaXMuYWN0aXZlRW50cmllcyB9KTtcbiAgICB9O1xuICAgIEFyZWFDaGFydFN0YWNrZWRDb21wb25lbnQucHJvdG90eXBlLmRlYWN0aXZhdGVBbGwgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBlXzMsIF9hO1xuICAgICAgICB0aGlzLmFjdGl2ZUVudHJpZXMgPSBfX3NwcmVhZCh0aGlzLmFjdGl2ZUVudHJpZXMpO1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgZm9yICh2YXIgX2IgPSBfX3ZhbHVlcyh0aGlzLmFjdGl2ZUVudHJpZXMpLCBfYyA9IF9iLm5leHQoKTsgIV9jLmRvbmU7IF9jID0gX2IubmV4dCgpKSB7XG4gICAgICAgICAgICAgICAgdmFyIGVudHJ5ID0gX2MudmFsdWU7XG4gICAgICAgICAgICAgICAgdGhpcy5kZWFjdGl2YXRlLmVtaXQoeyB2YWx1ZTogZW50cnksIGVudHJpZXM6IFtdIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGNhdGNoIChlXzNfMSkgeyBlXzMgPSB7IGVycm9yOiBlXzNfMSB9OyB9XG4gICAgICAgIGZpbmFsbHkge1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICBpZiAoX2MgJiYgIV9jLmRvbmUgJiYgKF9hID0gX2IucmV0dXJuKSkgX2EuY2FsbChfYik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBmaW5hbGx5IHsgaWYgKGVfMykgdGhyb3cgZV8zLmVycm9yOyB9XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5hY3RpdmVFbnRyaWVzID0gW107XG4gICAgfTtcbiAgICBfX2RlY29yYXRlKFtcbiAgICAgICAgSW5wdXQoKVxuICAgIF0sIEFyZWFDaGFydFN0YWNrZWRDb21wb25lbnQucHJvdG90eXBlLCBcImxlZ2VuZFwiLCB2b2lkIDApO1xuICAgIF9fZGVjb3JhdGUoW1xuICAgICAgICBJbnB1dCgpXG4gICAgXSwgQXJlYUNoYXJ0U3RhY2tlZENvbXBvbmVudC5wcm90b3R5cGUsIFwibGVnZW5kVGl0bGVcIiwgdm9pZCAwKTtcbiAgICBfX2RlY29yYXRlKFtcbiAgICAgICAgSW5wdXQoKVxuICAgIF0sIEFyZWFDaGFydFN0YWNrZWRDb21wb25lbnQucHJvdG90eXBlLCBcImxlZ2VuZFBvc2l0aW9uXCIsIHZvaWQgMCk7XG4gICAgX19kZWNvcmF0ZShbXG4gICAgICAgIElucHV0KClcbiAgICBdLCBBcmVhQ2hhcnRTdGFja2VkQ29tcG9uZW50LnByb3RvdHlwZSwgXCJ4QXhpc1wiLCB2b2lkIDApO1xuICAgIF9fZGVjb3JhdGUoW1xuICAgICAgICBJbnB1dCgpXG4gICAgXSwgQXJlYUNoYXJ0U3RhY2tlZENvbXBvbmVudC5wcm90b3R5cGUsIFwieUF4aXNcIiwgdm9pZCAwKTtcbiAgICBfX2RlY29yYXRlKFtcbiAgICAgICAgSW5wdXQoKVxuICAgIF0sIEFyZWFDaGFydFN0YWNrZWRDb21wb25lbnQucHJvdG90eXBlLCBcInNob3dYQXhpc0xhYmVsXCIsIHZvaWQgMCk7XG4gICAgX19kZWNvcmF0ZShbXG4gICAgICAgIElucHV0KClcbiAgICBdLCBBcmVhQ2hhcnRTdGFja2VkQ29tcG9uZW50LnByb3RvdHlwZSwgXCJzaG93WUF4aXNMYWJlbFwiLCB2b2lkIDApO1xuICAgIF9fZGVjb3JhdGUoW1xuICAgICAgICBJbnB1dCgpXG4gICAgXSwgQXJlYUNoYXJ0U3RhY2tlZENvbXBvbmVudC5wcm90b3R5cGUsIFwieEF4aXNMYWJlbFwiLCB2b2lkIDApO1xuICAgIF9fZGVjb3JhdGUoW1xuICAgICAgICBJbnB1dCgpXG4gICAgXSwgQXJlYUNoYXJ0U3RhY2tlZENvbXBvbmVudC5wcm90b3R5cGUsIFwieUF4aXNMYWJlbFwiLCB2b2lkIDApO1xuICAgIF9fZGVjb3JhdGUoW1xuICAgICAgICBJbnB1dCgpXG4gICAgXSwgQXJlYUNoYXJ0U3RhY2tlZENvbXBvbmVudC5wcm90b3R5cGUsIFwidGltZWxpbmVcIiwgdm9pZCAwKTtcbiAgICBfX2RlY29yYXRlKFtcbiAgICAgICAgSW5wdXQoKVxuICAgIF0sIEFyZWFDaGFydFN0YWNrZWRDb21wb25lbnQucHJvdG90eXBlLCBcImdyYWRpZW50XCIsIHZvaWQgMCk7XG4gICAgX19kZWNvcmF0ZShbXG4gICAgICAgIElucHV0KClcbiAgICBdLCBBcmVhQ2hhcnRTdGFja2VkQ29tcG9uZW50LnByb3RvdHlwZSwgXCJzaG93R3JpZExpbmVzXCIsIHZvaWQgMCk7XG4gICAgX19kZWNvcmF0ZShbXG4gICAgICAgIElucHV0KClcbiAgICBdLCBBcmVhQ2hhcnRTdGFja2VkQ29tcG9uZW50LnByb3RvdHlwZSwgXCJjdXJ2ZVwiLCB2b2lkIDApO1xuICAgIF9fZGVjb3JhdGUoW1xuICAgICAgICBJbnB1dCgpXG4gICAgXSwgQXJlYUNoYXJ0U3RhY2tlZENvbXBvbmVudC5wcm90b3R5cGUsIFwiYWN0aXZlRW50cmllc1wiLCB2b2lkIDApO1xuICAgIF9fZGVjb3JhdGUoW1xuICAgICAgICBJbnB1dCgpXG4gICAgXSwgQXJlYUNoYXJ0U3RhY2tlZENvbXBvbmVudC5wcm90b3R5cGUsIFwic2NoZW1lVHlwZVwiLCB2b2lkIDApO1xuICAgIF9fZGVjb3JhdGUoW1xuICAgICAgICBJbnB1dCgpXG4gICAgXSwgQXJlYUNoYXJ0U3RhY2tlZENvbXBvbmVudC5wcm90b3R5cGUsIFwidHJpbVhBeGlzVGlja3NcIiwgdm9pZCAwKTtcbiAgICBfX2RlY29yYXRlKFtcbiAgICAgICAgSW5wdXQoKVxuICAgIF0sIEFyZWFDaGFydFN0YWNrZWRDb21wb25lbnQucHJvdG90eXBlLCBcInRyaW1ZQXhpc1RpY2tzXCIsIHZvaWQgMCk7XG4gICAgX19kZWNvcmF0ZShbXG4gICAgICAgIElucHV0KClcbiAgICBdLCBBcmVhQ2hhcnRTdGFja2VkQ29tcG9uZW50LnByb3RvdHlwZSwgXCJyb3RhdGVYQXhpc1RpY2tzXCIsIHZvaWQgMCk7XG4gICAgX19kZWNvcmF0ZShbXG4gICAgICAgIElucHV0KClcbiAgICBdLCBBcmVhQ2hhcnRTdGFja2VkQ29tcG9uZW50LnByb3RvdHlwZSwgXCJtYXhYQXhpc1RpY2tMZW5ndGhcIiwgdm9pZCAwKTtcbiAgICBfX2RlY29yYXRlKFtcbiAgICAgICAgSW5wdXQoKVxuICAgIF0sIEFyZWFDaGFydFN0YWNrZWRDb21wb25lbnQucHJvdG90eXBlLCBcIm1heFlBeGlzVGlja0xlbmd0aFwiLCB2b2lkIDApO1xuICAgIF9fZGVjb3JhdGUoW1xuICAgICAgICBJbnB1dCgpXG4gICAgXSwgQXJlYUNoYXJ0U3RhY2tlZENvbXBvbmVudC5wcm90b3R5cGUsIFwieEF4aXNUaWNrRm9ybWF0dGluZ1wiLCB2b2lkIDApO1xuICAgIF9fZGVjb3JhdGUoW1xuICAgICAgICBJbnB1dCgpXG4gICAgXSwgQXJlYUNoYXJ0U3RhY2tlZENvbXBvbmVudC5wcm90b3R5cGUsIFwieUF4aXNUaWNrRm9ybWF0dGluZ1wiLCB2b2lkIDApO1xuICAgIF9fZGVjb3JhdGUoW1xuICAgICAgICBJbnB1dCgpXG4gICAgXSwgQXJlYUNoYXJ0U3RhY2tlZENvbXBvbmVudC5wcm90b3R5cGUsIFwieEF4aXNUaWNrc1wiLCB2b2lkIDApO1xuICAgIF9fZGVjb3JhdGUoW1xuICAgICAgICBJbnB1dCgpXG4gICAgXSwgQXJlYUNoYXJ0U3RhY2tlZENvbXBvbmVudC5wcm90b3R5cGUsIFwieUF4aXNUaWNrc1wiLCB2b2lkIDApO1xuICAgIF9fZGVjb3JhdGUoW1xuICAgICAgICBJbnB1dCgpXG4gICAgXSwgQXJlYUNoYXJ0U3RhY2tlZENvbXBvbmVudC5wcm90b3R5cGUsIFwicm91bmREb21haW5zXCIsIHZvaWQgMCk7XG4gICAgX19kZWNvcmF0ZShbXG4gICAgICAgIElucHV0KClcbiAgICBdLCBBcmVhQ2hhcnRTdGFja2VkQ29tcG9uZW50LnByb3RvdHlwZSwgXCJ0b29sdGlwRGlzYWJsZWRcIiwgdm9pZCAwKTtcbiAgICBfX2RlY29yYXRlKFtcbiAgICAgICAgSW5wdXQoKVxuICAgIF0sIEFyZWFDaGFydFN0YWNrZWRDb21wb25lbnQucHJvdG90eXBlLCBcInhTY2FsZU1pblwiLCB2b2lkIDApO1xuICAgIF9fZGVjb3JhdGUoW1xuICAgICAgICBJbnB1dCgpXG4gICAgXSwgQXJlYUNoYXJ0U3RhY2tlZENvbXBvbmVudC5wcm90b3R5cGUsIFwieFNjYWxlTWF4XCIsIHZvaWQgMCk7XG4gICAgX19kZWNvcmF0ZShbXG4gICAgICAgIElucHV0KClcbiAgICBdLCBBcmVhQ2hhcnRTdGFja2VkQ29tcG9uZW50LnByb3RvdHlwZSwgXCJ5U2NhbGVNaW5cIiwgdm9pZCAwKTtcbiAgICBfX2RlY29yYXRlKFtcbiAgICAgICAgSW5wdXQoKVxuICAgIF0sIEFyZWFDaGFydFN0YWNrZWRDb21wb25lbnQucHJvdG90eXBlLCBcInlTY2FsZU1heFwiLCB2b2lkIDApO1xuICAgIF9fZGVjb3JhdGUoW1xuICAgICAgICBPdXRwdXQoKVxuICAgIF0sIEFyZWFDaGFydFN0YWNrZWRDb21wb25lbnQucHJvdG90eXBlLCBcImFjdGl2YXRlXCIsIHZvaWQgMCk7XG4gICAgX19kZWNvcmF0ZShbXG4gICAgICAgIE91dHB1dCgpXG4gICAgXSwgQXJlYUNoYXJ0U3RhY2tlZENvbXBvbmVudC5wcm90b3R5cGUsIFwiZGVhY3RpdmF0ZVwiLCB2b2lkIDApO1xuICAgIF9fZGVjb3JhdGUoW1xuICAgICAgICBDb250ZW50Q2hpbGQoJ3Rvb2x0aXBUZW1wbGF0ZScpXG4gICAgXSwgQXJlYUNoYXJ0U3RhY2tlZENvbXBvbmVudC5wcm90b3R5cGUsIFwidG9vbHRpcFRlbXBsYXRlXCIsIHZvaWQgMCk7XG4gICAgX19kZWNvcmF0ZShbXG4gICAgICAgIENvbnRlbnRDaGlsZCgnc2VyaWVzVG9vbHRpcFRlbXBsYXRlJylcbiAgICBdLCBBcmVhQ2hhcnRTdGFja2VkQ29tcG9uZW50LnByb3RvdHlwZSwgXCJzZXJpZXNUb29sdGlwVGVtcGxhdGVcIiwgdm9pZCAwKTtcbiAgICBfX2RlY29yYXRlKFtcbiAgICAgICAgSG9zdExpc3RlbmVyKCdtb3VzZWxlYXZlJylcbiAgICBdLCBBcmVhQ2hhcnRTdGFja2VkQ29tcG9uZW50LnByb3RvdHlwZSwgXCJoaWRlQ2lyY2xlc1wiLCBudWxsKTtcbiAgICBBcmVhQ2hhcnRTdGFja2VkQ29tcG9uZW50ID0gX19kZWNvcmF0ZShbXG4gICAgICAgIENvbXBvbmVudCh7XG4gICAgICAgICAgICBzZWxlY3RvcjogJ25neC1jaGFydHMtYXJlYS1jaGFydC1zdGFja2VkJyxcbiAgICAgICAgICAgIHRlbXBsYXRlOiBcIlxcbiAgICA8bmd4LWNoYXJ0cy1jaGFydFxcbiAgICAgIFt2aWV3XT1cXFwiW3dpZHRoLCBoZWlnaHRdXFxcIlxcbiAgICAgIFtzaG93TGVnZW5kXT1cXFwibGVnZW5kXFxcIlxcbiAgICAgIFtsZWdlbmRPcHRpb25zXT1cXFwibGVnZW5kT3B0aW9uc1xcXCJcXG4gICAgICBbYWN0aXZlRW50cmllc109XFxcImFjdGl2ZUVudHJpZXNcXFwiXFxuICAgICAgW2FuaW1hdGlvbnNdPVxcXCJhbmltYXRpb25zXFxcIlxcbiAgICAgIChsZWdlbmRMYWJlbENsaWNrKT1cXFwib25DbGljaygkZXZlbnQpXFxcIlxcbiAgICAgIChsZWdlbmRMYWJlbEFjdGl2YXRlKT1cXFwib25BY3RpdmF0ZSgkZXZlbnQpXFxcIlxcbiAgICAgIChsZWdlbmRMYWJlbERlYWN0aXZhdGUpPVxcXCJvbkRlYWN0aXZhdGUoJGV2ZW50KVxcXCJcXG4gICAgPlxcbiAgICAgIDxzdmc6ZGVmcz5cXG4gICAgICAgIDxzdmc6Y2xpcFBhdGggW2F0dHIuaWRdPVxcXCJjbGlwUGF0aElkXFxcIj5cXG4gICAgICAgICAgPHN2ZzpyZWN0XFxuICAgICAgICAgICAgW2F0dHIud2lkdGhdPVxcXCJkaW1zLndpZHRoICsgMTBcXFwiXFxuICAgICAgICAgICAgW2F0dHIuaGVpZ2h0XT1cXFwiZGltcy5oZWlnaHQgKyAxMFxcXCJcXG4gICAgICAgICAgICBbYXR0ci50cmFuc2Zvcm1dPVxcXCIndHJhbnNsYXRlKC01LCAtNSknXFxcIlxcbiAgICAgICAgICAvPlxcbiAgICAgICAgPC9zdmc6Y2xpcFBhdGg+XFxuICAgICAgPC9zdmc6ZGVmcz5cXG4gICAgICA8c3ZnOmcgW2F0dHIudHJhbnNmb3JtXT1cXFwidHJhbnNmb3JtXFxcIiBjbGFzcz1cXFwiYXJlYS1jaGFydCBjaGFydFxcXCI+XFxuICAgICAgICA8c3ZnOmdcXG4gICAgICAgICAgbmd4LWNoYXJ0cy14LWF4aXNcXG4gICAgICAgICAgKm5nSWY9XFxcInhBeGlzXFxcIlxcbiAgICAgICAgICBbeFNjYWxlXT1cXFwieFNjYWxlXFxcIlxcbiAgICAgICAgICBbZGltc109XFxcImRpbXNcXFwiXFxuICAgICAgICAgIFtzaG93R3JpZExpbmVzXT1cXFwic2hvd0dyaWRMaW5lc1xcXCJcXG4gICAgICAgICAgW3Nob3dMYWJlbF09XFxcInNob3dYQXhpc0xhYmVsXFxcIlxcbiAgICAgICAgICBbbGFiZWxUZXh0XT1cXFwieEF4aXNMYWJlbFxcXCJcXG4gICAgICAgICAgW3RyaW1UaWNrc109XFxcInRyaW1YQXhpc1RpY2tzXFxcIlxcbiAgICAgICAgICBbcm90YXRlVGlja3NdPVxcXCJyb3RhdGVYQXhpc1RpY2tzXFxcIlxcbiAgICAgICAgICBbbWF4VGlja0xlbmd0aF09XFxcIm1heFhBeGlzVGlja0xlbmd0aFxcXCJcXG4gICAgICAgICAgW3RpY2tGb3JtYXR0aW5nXT1cXFwieEF4aXNUaWNrRm9ybWF0dGluZ1xcXCJcXG4gICAgICAgICAgW3RpY2tzXT1cXFwieEF4aXNUaWNrc1xcXCJcXG4gICAgICAgICAgKGRpbWVuc2lvbnNDaGFuZ2VkKT1cXFwidXBkYXRlWEF4aXNIZWlnaHQoJGV2ZW50KVxcXCJcXG4gICAgICAgID48L3N2ZzpnPlxcbiAgICAgICAgPHN2ZzpnXFxuICAgICAgICAgIG5neC1jaGFydHMteS1heGlzXFxuICAgICAgICAgICpuZ0lmPVxcXCJ5QXhpc1xcXCJcXG4gICAgICAgICAgW3lTY2FsZV09XFxcInlTY2FsZVxcXCJcXG4gICAgICAgICAgW2RpbXNdPVxcXCJkaW1zXFxcIlxcbiAgICAgICAgICBbc2hvd0dyaWRMaW5lc109XFxcInNob3dHcmlkTGluZXNcXFwiXFxuICAgICAgICAgIFtzaG93TGFiZWxdPVxcXCJzaG93WUF4aXNMYWJlbFxcXCJcXG4gICAgICAgICAgW2xhYmVsVGV4dF09XFxcInlBeGlzTGFiZWxcXFwiXFxuICAgICAgICAgIFt0cmltVGlja3NdPVxcXCJ0cmltWUF4aXNUaWNrc1xcXCJcXG4gICAgICAgICAgW21heFRpY2tMZW5ndGhdPVxcXCJtYXhZQXhpc1RpY2tMZW5ndGhcXFwiXFxuICAgICAgICAgIFt0aWNrRm9ybWF0dGluZ109XFxcInlBeGlzVGlja0Zvcm1hdHRpbmdcXFwiXFxuICAgICAgICAgIFt0aWNrc109XFxcInlBeGlzVGlja3NcXFwiXFxuICAgICAgICAgIChkaW1lbnNpb25zQ2hhbmdlZCk9XFxcInVwZGF0ZVlBeGlzV2lkdGgoJGV2ZW50KVxcXCJcXG4gICAgICAgID48L3N2ZzpnPlxcbiAgICAgICAgPHN2ZzpnIFthdHRyLmNsaXAtcGF0aF09XFxcImNsaXBQYXRoXFxcIj5cXG4gICAgICAgICAgPHN2ZzpnICpuZ0Zvcj1cXFwibGV0IHNlcmllcyBvZiByZXN1bHRzOyB0cmFja0J5OiB0cmFja0J5XFxcIj5cXG4gICAgICAgICAgICA8c3ZnOmdcXG4gICAgICAgICAgICAgIG5neC1jaGFydHMtYXJlYS1zZXJpZXNcXG4gICAgICAgICAgICAgIFt4U2NhbGVdPVxcXCJ4U2NhbGVcXFwiXFxuICAgICAgICAgICAgICBbeVNjYWxlXT1cXFwieVNjYWxlXFxcIlxcbiAgICAgICAgICAgICAgW2NvbG9yc109XFxcImNvbG9yc1xcXCJcXG4gICAgICAgICAgICAgIFtkYXRhXT1cXFwic2VyaWVzXFxcIlxcbiAgICAgICAgICAgICAgW3NjYWxlVHlwZV09XFxcInNjYWxlVHlwZVxcXCJcXG4gICAgICAgICAgICAgIFtncmFkaWVudF09XFxcImdyYWRpZW50XFxcIlxcbiAgICAgICAgICAgICAgW2FjdGl2ZUVudHJpZXNdPVxcXCJhY3RpdmVFbnRyaWVzXFxcIlxcbiAgICAgICAgICAgICAgc3RhY2tlZD1cXFwidHJ1ZVxcXCJcXG4gICAgICAgICAgICAgIFtjdXJ2ZV09XFxcImN1cnZlXFxcIlxcbiAgICAgICAgICAgICAgW2FuaW1hdGlvbnNdPVxcXCJhbmltYXRpb25zXFxcIlxcbiAgICAgICAgICAgIC8+XFxuICAgICAgICAgIDwvc3ZnOmc+XFxuXFxuICAgICAgICAgIDxzdmc6ZyAqbmdJZj1cXFwiIXRvb2x0aXBEaXNhYmxlZFxcXCIgKG1vdXNlbGVhdmUpPVxcXCJoaWRlQ2lyY2xlcygpXFxcIj5cXG4gICAgICAgICAgICA8c3ZnOmdcXG4gICAgICAgICAgICAgIG5neC1jaGFydHMtdG9vbHRpcC1hcmVhXFxuICAgICAgICAgICAgICBbZGltc109XFxcImRpbXNcXFwiXFxuICAgICAgICAgICAgICBbeFNldF09XFxcInhTZXRcXFwiXFxuICAgICAgICAgICAgICBbeFNjYWxlXT1cXFwieFNjYWxlXFxcIlxcbiAgICAgICAgICAgICAgW3lTY2FsZV09XFxcInlTY2FsZVxcXCJcXG4gICAgICAgICAgICAgIFtyZXN1bHRzXT1cXFwicmVzdWx0c1xcXCJcXG4gICAgICAgICAgICAgIFtjb2xvcnNdPVxcXCJjb2xvcnNcXFwiXFxuICAgICAgICAgICAgICBbdG9vbHRpcERpc2FibGVkXT1cXFwidG9vbHRpcERpc2FibGVkXFxcIlxcbiAgICAgICAgICAgICAgW3Rvb2x0aXBUZW1wbGF0ZV09XFxcInNlcmllc1Rvb2x0aXBUZW1wbGF0ZVxcXCJcXG4gICAgICAgICAgICAgIChob3Zlcik9XFxcInVwZGF0ZUhvdmVyZWRWZXJ0aWNhbCgkZXZlbnQpXFxcIlxcbiAgICAgICAgICAgIC8+XFxuXFxuICAgICAgICAgICAgPHN2ZzpnICpuZ0Zvcj1cXFwibGV0IHNlcmllcyBvZiByZXN1bHRzOyB0cmFja0J5OiB0cmFja0J5XFxcIj5cXG4gICAgICAgICAgICAgIDxzdmc6Z1xcbiAgICAgICAgICAgICAgICBuZ3gtY2hhcnRzLWNpcmNsZS1zZXJpZXNcXG4gICAgICAgICAgICAgICAgdHlwZT1cXFwic3RhY2tlZFxcXCJcXG4gICAgICAgICAgICAgICAgW3hTY2FsZV09XFxcInhTY2FsZVxcXCJcXG4gICAgICAgICAgICAgICAgW3lTY2FsZV09XFxcInlTY2FsZVxcXCJcXG4gICAgICAgICAgICAgICAgW2NvbG9yc109XFxcImNvbG9yc1xcXCJcXG4gICAgICAgICAgICAgICAgW2FjdGl2ZUVudHJpZXNdPVxcXCJhY3RpdmVFbnRyaWVzXFxcIlxcbiAgICAgICAgICAgICAgICBbZGF0YV09XFxcInNlcmllc1xcXCJcXG4gICAgICAgICAgICAgICAgW3NjYWxlVHlwZV09XFxcInNjYWxlVHlwZVxcXCJcXG4gICAgICAgICAgICAgICAgW3Zpc2libGVWYWx1ZV09XFxcImhvdmVyZWRWZXJ0aWNhbFxcXCJcXG4gICAgICAgICAgICAgICAgW3Rvb2x0aXBEaXNhYmxlZF09XFxcInRvb2x0aXBEaXNhYmxlZFxcXCJcXG4gICAgICAgICAgICAgICAgW3Rvb2x0aXBUZW1wbGF0ZV09XFxcInRvb2x0aXBUZW1wbGF0ZVxcXCJcXG4gICAgICAgICAgICAgICAgKHNlbGVjdCk9XFxcIm9uQ2xpY2soJGV2ZW50LCBzZXJpZXMpXFxcIlxcbiAgICAgICAgICAgICAgICAoYWN0aXZhdGUpPVxcXCJvbkFjdGl2YXRlKCRldmVudClcXFwiXFxuICAgICAgICAgICAgICAgIChkZWFjdGl2YXRlKT1cXFwib25EZWFjdGl2YXRlKCRldmVudClcXFwiXFxuICAgICAgICAgICAgICAvPlxcbiAgICAgICAgICAgIDwvc3ZnOmc+XFxuICAgICAgICAgIDwvc3ZnOmc+XFxuICAgICAgICA8L3N2ZzpnPlxcbiAgICAgIDwvc3ZnOmc+XFxuICAgICAgPHN2ZzpnXFxuICAgICAgICBuZ3gtY2hhcnRzLXRpbWVsaW5lXFxuICAgICAgICAqbmdJZj1cXFwidGltZWxpbmUgJiYgc2NhbGVUeXBlICE9ICdvcmRpbmFsJ1xcXCJcXG4gICAgICAgIFthdHRyLnRyYW5zZm9ybV09XFxcInRpbWVsaW5lVHJhbnNmb3JtXFxcIlxcbiAgICAgICAgW3Jlc3VsdHNdPVxcXCJyZXN1bHRzXFxcIlxcbiAgICAgICAgW3ZpZXddPVxcXCJbdGltZWxpbmVXaWR0aCwgaGVpZ2h0XVxcXCJcXG4gICAgICAgIFtoZWlnaHRdPVxcXCJ0aW1lbGluZUhlaWdodFxcXCJcXG4gICAgICAgIFtzY2hlbWVdPVxcXCJzY2hlbWVcXFwiXFxuICAgICAgICBbY3VzdG9tQ29sb3JzXT1cXFwiY3VzdG9tQ29sb3JzXFxcIlxcbiAgICAgICAgW2xlZ2VuZF09XFxcImxlZ2VuZFxcXCJcXG4gICAgICAgIFtzY2FsZVR5cGVdPVxcXCJzY2FsZVR5cGVcXFwiXFxuICAgICAgICAob25Eb21haW5DaGFuZ2UpPVxcXCJ1cGRhdGVEb21haW4oJGV2ZW50KVxcXCJcXG4gICAgICA+XFxuICAgICAgICA8c3ZnOmcgKm5nRm9yPVxcXCJsZXQgc2VyaWVzIG9mIHJlc3VsdHM7IHRyYWNrQnk6IHRyYWNrQnlcXFwiPlxcbiAgICAgICAgICA8c3ZnOmdcXG4gICAgICAgICAgICBuZ3gtY2hhcnRzLWFyZWEtc2VyaWVzXFxuICAgICAgICAgICAgW3hTY2FsZV09XFxcInRpbWVsaW5lWFNjYWxlXFxcIlxcbiAgICAgICAgICAgIFt5U2NhbGVdPVxcXCJ0aW1lbGluZVlTY2FsZVxcXCJcXG4gICAgICAgICAgICBbY29sb3JzXT1cXFwiY29sb3JzXFxcIlxcbiAgICAgICAgICAgIFtkYXRhXT1cXFwic2VyaWVzXFxcIlxcbiAgICAgICAgICAgIFtzY2FsZVR5cGVdPVxcXCJzY2FsZVR5cGVcXFwiXFxuICAgICAgICAgICAgW2dyYWRpZW50XT1cXFwiZ3JhZGllbnRcXFwiXFxuICAgICAgICAgICAgc3RhY2tlZD1cXFwidHJ1ZVxcXCJcXG4gICAgICAgICAgICBbY3VydmVdPVxcXCJjdXJ2ZVxcXCJcXG4gICAgICAgICAgICBbYW5pbWF0aW9uc109XFxcImFuaW1hdGlvbnNcXFwiXFxuICAgICAgICAgIC8+XFxuICAgICAgICA8L3N2ZzpnPlxcbiAgICAgIDwvc3ZnOmc+XFxuICAgIDwvbmd4LWNoYXJ0cy1jaGFydD5cXG4gIFwiLFxuICAgICAgICAgICAgY2hhbmdlRGV0ZWN0aW9uOiBDaGFuZ2VEZXRlY3Rpb25TdHJhdGVneS5PblB1c2gsXG4gICAgICAgICAgICBlbmNhcHN1bGF0aW9uOiBWaWV3RW5jYXBzdWxhdGlvbi5Ob25lLFxuICAgICAgICAgICAgc3R5bGVzOiBbXCIubmd4LWNoYXJ0c3tmbG9hdDpsZWZ0O292ZXJmbG93OnZpc2libGV9Lm5neC1jaGFydHMgLmFyYywubmd4LWNoYXJ0cyAuYmFyLC5uZ3gtY2hhcnRzIC5jaXJjbGV7Y3Vyc29yOnBvaW50ZXJ9Lm5neC1jaGFydHMgLmFyYy5hY3RpdmUsLm5neC1jaGFydHMgLmFyYzpob3Zlciwubmd4LWNoYXJ0cyAuYmFyLmFjdGl2ZSwubmd4LWNoYXJ0cyAuYmFyOmhvdmVyLC5uZ3gtY2hhcnRzIC5jYXJkLmFjdGl2ZSwubmd4LWNoYXJ0cyAuY2FyZDpob3Zlciwubmd4LWNoYXJ0cyAuY2VsbC5hY3RpdmUsLm5neC1jaGFydHMgLmNlbGw6aG92ZXJ7b3BhY2l0eTouODstd2Via2l0LXRyYW5zaXRpb246b3BhY2l0eSAuMXMgZWFzZS1pbi1vdXQ7dHJhbnNpdGlvbjpvcGFjaXR5IC4xcyBlYXNlLWluLW91dH0ubmd4LWNoYXJ0cyAuYXJjOmZvY3VzLC5uZ3gtY2hhcnRzIC5iYXI6Zm9jdXMsLm5neC1jaGFydHMgLmNhcmQ6Zm9jdXMsLm5neC1jaGFydHMgLmNlbGw6Zm9jdXN7b3V0bGluZTowfS5uZ3gtY2hhcnRzIC5hcmMuaGlkZGVuLC5uZ3gtY2hhcnRzIC5iYXIuaGlkZGVuLC5uZ3gtY2hhcnRzIC5jYXJkLmhpZGRlbiwubmd4LWNoYXJ0cyAuY2VsbC5oaWRkZW57ZGlzcGxheTpub25lfS5uZ3gtY2hhcnRzIGc6Zm9jdXN7b3V0bGluZTowfS5uZ3gtY2hhcnRzIC5hcmVhLXNlcmllcy5pbmFjdGl2ZSwubmd4LWNoYXJ0cyAubGluZS1zZXJpZXMtcmFuZ2UuaW5hY3RpdmUsLm5neC1jaGFydHMgLmxpbmUtc2VyaWVzLmluYWN0aXZlLC5uZ3gtY2hhcnRzIC5wb2xhci1zZXJpZXMtYXJlYS5pbmFjdGl2ZSwubmd4LWNoYXJ0cyAucG9sYXItc2VyaWVzLXBhdGguaW5hY3RpdmV7LXdlYmtpdC10cmFuc2l0aW9uOm9wYWNpdHkgLjFzIGVhc2UtaW4tb3V0O3RyYW5zaXRpb246b3BhY2l0eSAuMXMgZWFzZS1pbi1vdXQ7b3BhY2l0eTouMn0ubmd4LWNoYXJ0cyAubGluZS1oaWdobGlnaHR7ZGlzcGxheTpub25lfS5uZ3gtY2hhcnRzIC5saW5lLWhpZ2hsaWdodC5hY3RpdmV7ZGlzcGxheTpibG9ja30ubmd4LWNoYXJ0cyAuYXJlYXtvcGFjaXR5Oi42fS5uZ3gtY2hhcnRzIC5jaXJjbGU6aG92ZXJ7Y3Vyc29yOnBvaW50ZXJ9Lm5neC1jaGFydHMgLmxhYmVse2ZvbnQtc2l6ZToxMnB4O2ZvbnQtd2VpZ2h0OjQwMH0ubmd4LWNoYXJ0cyAudG9vbHRpcC1hbmNob3J7ZmlsbDojMDAwfS5uZ3gtY2hhcnRzIC5ncmlkbGluZS1wYXRoe3N0cm9rZTojZGRkO3N0cm9rZS13aWR0aDoxO2ZpbGw6bm9uZX0ubmd4LWNoYXJ0cyAucmVmbGluZS1wYXRoe3N0cm9rZTojYThiMmM3O3N0cm9rZS13aWR0aDoxO3N0cm9rZS1kYXNoYXJyYXk6NTtzdHJva2UtZGFzaG9mZnNldDo1fS5uZ3gtY2hhcnRzIC5yZWZsaW5lLWxhYmVse2ZvbnQtc2l6ZTo5cHh9Lm5neC1jaGFydHMgLnJlZmVyZW5jZS1hcmVhe2ZpbGwtb3BhY2l0eTouMDU7ZmlsbDojMDAwfS5uZ3gtY2hhcnRzIC5ncmlkbGluZS1wYXRoLWRvdHRlZHtzdHJva2U6I2RkZDtzdHJva2Utd2lkdGg6MTtmaWxsOm5vbmU7c3Ryb2tlLWRhc2hhcnJheToxLDIwO3N0cm9rZS1kYXNob2Zmc2V0OjN9Lm5neC1jaGFydHMgLmdyaWQtcGFuZWwgcmVjdHtmaWxsOm5vbmV9Lm5neC1jaGFydHMgLmdyaWQtcGFuZWwub2RkIHJlY3R7ZmlsbDpyZ2JhKDAsMCwwLC4wNSl9XCJdXG4gICAgICAgIH0pXG4gICAgXSwgQXJlYUNoYXJ0U3RhY2tlZENvbXBvbmVudCk7XG4gICAgcmV0dXJuIEFyZWFDaGFydFN0YWNrZWRDb21wb25lbnQ7XG59KEJhc2VDaGFydENvbXBvbmVudCkpO1xuZXhwb3J0IHsgQXJlYUNoYXJ0U3RhY2tlZENvbXBvbmVudCB9O1xuIl19